<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Idea {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Appendix C</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="appendix-c-simulations-bootstrap" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Appendix C: <br>Simulations &amp; Bootstrap</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline-of-appendix-c" class="slide level2">
<h2>Outline of Appendix C</h2>
<div class="column" style="width:50%;">
<ol type="1">
<li>Monte Carlo simulations</li>
<li>Simulating p-values</li>
<li>The Bootstrap</li>
</ol>
</div><div class="column" style="width:50%;">
<ol start="4" type="1">
<li>Bootstrap Confidence Intervals</li>
<li>Bootstrap t-test</li>
<li>Bootstrap F-test</li>
</ol>
</div></section></section>
<section>
<section id="part-1-monte-carlo-simulations" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Monte Carlo <br> simulations</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="for-simple-counts-we-said-that" class="slide level2 smaller">
<h2>For simple counts, we said that:</h2>
<ul>
<li><p>The distribution of the <span class="math inline">\chi^2</span> statistic is approximately <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
<li><p>The approximation is:</p>
<table class="caption-top">
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Good</strong></th>
<th style="text-align: left;"><span class="math inline">E_i \geq 5  \, \text{ for all } \, i = 1 , \ldots n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Bad</strong></td>
<td style="text-align: left;"><span class="math inline">E_i &lt; 5 \,</span> for some <span class="math inline">\, i = 1 , \ldots n</span></td>
</tr>
</tbody>
</table></li>
<li><p><strong>How to compute the p-value:</strong> When approximation is</p>
<ul>
<li><strong>Good:</strong> Use <span class="math inline">\chi_{n-1}^2</span> approximation of <span class="math inline">\chi^2</span></li>
<li><strong>Bad:</strong> Use Monte Carlo simulations</li>
</ul></li>
<li><p><strong>Question:</strong> What is a Monte Carlo simulation?</p></li>
</ul>
</section>
<section id="monte-carlo-methods" class="slide level2 smaller">
<h2>Monte Carlo methods</h2>
<ul>
<li><strong>Monte Carlo methods:</strong>
<ul>
<li>Broad class of computational algorithms</li>
<li>They rely on repeated random sampling to obtain numerical results</li>
<li>Principle: use randomness to solve problems which are deterministic</li>
</ul></li>
<li><strong>Why the name?</strong>
<ul>
<li>Method was developed by <a href="https://en.wikipedia.org/wiki/Stanisław_Ulam">Stanislaw Ulam</a></li>
<li>His uncle liked to gamble in the Monte–Carlo Casino in Monaco</li>
</ul></li>
<li><strong>Examples of applications:</strong>
<ul>
<li>First used to solve problem of neutron diffusion in Los Alamos 1946</li>
<li>Can be used to compute integrals</li>
<li><strong>Can be used to compute p-values</strong></li>
</ul></li>
</ul>
</section>
<section id="example-approximation-of-pi" class="slide level2 smaller">
<h2>Example: Approximation of <span class="math inline">\pi</span></h2>
<div class="column" style="width:49%;">
<ul>
<li>Throw random points inside square of side <span class="math inline">2</span></li>
<li>Count proportion of points falling inside unit circle</li>
<li>Such proportion approximates <span class="math inline">\pi</span> (area of the circle)
<ul>
<li><span class="math inline">r = \,</span> Red point</li>
<li><span class="math inline">b = \,</span> Blue point</li>
<li><span class="math inline">n = r + b</span> Total points</li>
</ul></li>
</ul>
<p><span class="math display">
\frac{\pi}{4} \approx \frac{r}{n} \,\, \implies \,\,
\pi \approx \frac{4r}{n}
</span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="images/pi_monte_carlo.gif" style="width:80.0%"></p>
</div></section>
<section id="approximating-pi-formal-model" class="slide level2 smaller">
<h2>Approximating <span class="math inline">\pi</span> – Formal model</h2>
<ul>
<li><p>Draw <span class="math inline">x_1, \ldots, x_N</span> and <span class="math inline">y_1, \ldots, y_N</span> from <span class="math inline">{\rm Uniform(-1,1)}</span></p></li>
<li><p>Count the number of points <span class="math inline">(x_i,y_i)</span> falling inside circle of radius <span class="math inline">1</span></p></li>
<li><p>These are points satisfying condition <span class="math display">
x_i^2 + y_i^2 \leq 1
</span></p></li>
<li><p>Area of circle estimated with proportion of points falling inside circle: <span class="math display">
\text{Area} \ = \ \pi \ \approx \ \frac{\text{Number of points } (x_i,y_i) \text{ inside circle}}{N}  \ \times \ 4
</span></p></li>
<li><p>Note: <span class="math inline">4</span> is the area of square of side <span class="math inline">2</span></p></li>
</ul>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p><strong>Plot: 1000 random points in square of side 2</strong></p>

<img data-src="appendix_C_files/figure-revealjs/unnamed-chunk-1-1.png" width="960" class="r-stretch"></section>
<section id="approximation-of-pi-in-r" class="slide level2 smaller">
<h2>Approximation of <span class="math inline">\pi</span> in R</h2>
<div style="font-size: 0.93em">
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>      <span class="co"># We do 100000 iterations and print every 10000</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co"># Counts total number of points</span></span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>in_circle <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Counts points falling in circle</span></span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {   <span class="co"># This loop is for printing message every N iterations</span></span>
<span id="cb1-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {  <span class="co"># Loop in which points are counted</span></span>
<span id="cb1-7"><a aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>); y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>);  <span class="co"># sample point (x,y)</span></span>
<span id="cb1-8"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) {    </span>
<span id="cb1-9"><a aria-hidden="true" tabindex="-1"></a>      in_circle <span class="ot">&lt;-</span> in_circle <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># If (x,y) in circle increase counter</span></span>
<span id="cb1-10"><a aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-11"><a aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> total <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Increase total counter (in any case)</span></span>
<span id="cb1-12"><a aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-13"><a aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-14"><a aria-hidden="true" tabindex="-1"></a>  pi_approx <span class="ot">&lt;-</span> ( in_circle <span class="sc">/</span> total ) <span class="sc">*</span> <span class="dv">4</span>  <span class="co"># Compute approximate area</span></span>
<span id="cb1-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"After %8d iterations pi is %.08f, error is %.08f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb1-17"><a aria-hidden="true" tabindex="-1"></a>     (j <span class="sc">*</span> N), pi_approx, <span class="fu">abs</span>(pi_approx <span class="sc">-</span> pi)))</span>
<span id="cb1-18"><a aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The R code can be downloaded here <a href="codes/monte_carlo_pi.R">monte_carlo_pi.R</a></li>
</ul>
</section>
<section id="approximation-of-pi-in-r-output" class="slide level2 smaller">
<h2>Approximation of <span class="math inline">\pi</span> in R: Output</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>After    10000 iterations pi is 3.13120000, error is 0.01039265
After    20000 iterations pi is 3.12640000, error is 0.01519265
After    30000 iterations pi is 3.14066667, error is 0.00092599
After    40000 iterations pi is 3.13930000, error is 0.00229265
After    50000 iterations pi is 3.13824000, error is 0.00335265
After    60000 iterations pi is 3.14213333, error is 0.00054068
After    70000 iterations pi is 3.14428571, error is 0.00269306
After    80000 iterations pi is 3.14575000, error is 0.00415735
After    90000 iterations pi is 3.14893333, error is 0.00734068
After   100000 iterations pi is 3.14656000, error is 0.00496735</code></pre>
</div>
</div>
<p><strong>Note:</strong></p>
<ul>
<li><p>The error decreases overall, but there are random fluctuations</p></li>
<li><p>This is because we are trying to approximate <span class="math inline">\pi</span> by a random quantity</p></li>
</ul>
</section>
<section id="a-word-on-error-estimates" class="slide level2 smaller">
<h2>A word on error estimates</h2>
<div style="font-size: 0.93em">
<ul>
<li><p>Deriving error estimates for numerical methods is not easy (Numerical Analysis)</p></li>
<li><p>Going back to our example:</p>
<ul>
<li>Let <span class="math inline">n</span> denote the total number of points drawn</li>
<li>Let <span class="math inline">X_n</span> denote the proportion of points falling inside the unit circle</li>
</ul></li>
<li><p>For every <span class="math inline">\varepsilon&gt; 0</span> fixed, it can be shown that <span class="math display">
P( | X_n - \pi/4  | \geq \varepsilon) \leq   {\rm Error} = \frac{1}{20 n \varepsilon^2}
</span></p></li>
<li><p>To get small <em>Error</em>: <span class="math inline">\,\, \varepsilon</span> has to be small, <span class="math inline">n</span> has to be large</p>
<ul>
<li>Fixing a small error threshold <span class="math inline">\varepsilon</span> implies doing more iterations (larger <span class="math inline">n</span>)</li>
<li>Error estimate is probabilistic: Error fluctuates, but decreases with more iterations</li>
</ul></li>
<li><p>Estimate can be derived by interpreting the problem as the Monte Carlo integration of <span class="math inline">\int_0^1 \sqrt{1-x^2} \, dx = \pi /4</span>, see <a href="https://math.stackexchange.com/questions/19119/approximating-pi-using-monte-carlo-integration">stackexchange post</a></p></li>
</ul>
</div>
</section>
<section id="simulation-the-main-point-for-us" class="slide level2 smaller">
<h2>Simulation: The main point (for us)</h2>
<p>Simulation can be used to gain insight into the <strong>shape</strong> of a distribution:</p>
<ul>
<li><p>Mean and variance</p></li>
<li><p>Related probabilities (p-values)</p></li>
</ul>
<p>How to simulate in R:</p>
<ul>
<li>Use loops
<ul>
<li>Example: We used a <code>for</code> loop to simulate <span class="math inline">\pi</span></li>
</ul></li>
<li>Use ad hoc R commands
<ul>
<li><code>replicate(n, expr)</code> repeats expression n times and outputs results</li>
<li><code>apply(x, expr)</code> applies expression to the object <code>x</code></li>
</ul></li>
</ul>
</section>
<section id="example-estimating-mean-variance-of-overlinex" class="slide level2 smaller">
<h2>Example: Estimating mean / variance of <span class="math inline">\overline{X}</span></h2>
<p>Consider sample <span class="math inline">X_1, \ldots, X_n</span> from <span class="math inline">N(\mu,\sigma^2)</span></p>
<ul>
<li><p>Recall that the sample mean satisfies <span class="math display">
{\rm I\kern-.3em E}[\overline{X}] = \mu \,, \qquad {\rm Var}[\overline{X}] = \frac{\sigma^2}{n}
</span> (As <span class="math inline">n</span> gets larger, <span class="math inline">{\rm Var}[\overline{X}]</span> will be closer to <span class="math inline">0</span> <span class="math inline">\implies \overline{X} \approx \mu</span> when <span class="math inline">n</span> is large)</p></li>
<li><p>For example, if the sample size is <span class="math inline">n = 10</span>, mean <span class="math inline">\mu = 0</span> and sd <span class="math inline">\sigma = 1</span>, then <span class="math display">
{\rm I\kern-.3em E}[\overline{X}] = 0 \,, \qquad {\rm Var}[\overline{X}] = \frac{1}{10} = 0.1
</span></p></li>
<li><p>We can obtain the above quantitites through simulation<br>
(In fancy terms: <em>Estimating mean and variance of</em> <span class="math inline">\overline{X}</span>)</p></li>
</ul>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<ul>
<li>One simulation of <span class="math inline">\overline{X}</span> can be done as follows:
<ol type="1">
<li>Generate sample <span class="math inline">x_1, \ldots, x_n</span> from <span class="math inline">N(0,1)</span></li>
<li>Compute sample mean of <span class="math inline">x_1, \ldots, x_n</span></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the sample mean xbar</span></span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-4"><a aria-hidden="true" tabindex="-1"></a>sim.xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rnorm</span>(n)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>To simulate <span class="math inline">M = 1000</span> values from <span class="math inline">\overline{X}</span>, <strong>replicate</strong> the above command <span class="math inline">M</span> times</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate M = 1000 times the sample mean xbar</span></span>
<span id="cb4-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a aria-hidden="true" tabindex="-1"></a>sim.xbar <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">mean</span>(<span class="fu">rnorm</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The vector <code>sim.xbar</code> contains <span class="math inline">M=1000</span> simulations from <span class="math inline">\overline{X}</span></p></li>
<li><p>Reasonable to suppose that <code>sim.xbar</code> approximates the random variable <span class="math inline">\overline{X}</span><br>
(This can be made rigorous with Central Limit Thm)</p></li>
<li><p>Therefore, we can make the following estimation</p></li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: left;">Estimation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">{\rm I\kern-.3em E}[\overline{X}]</span></td>
<td style="text-align: left;">Sample mean of <code>sim.xbar</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">{\rm Var}[\overline{X}]</span></td>
<td style="text-align: left;">Sample variance of <code>sim.xbar</code></td>
</tr>
</tbody>
</table>
<div style="font-size: 0.51em">
<p><br></p>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print mean and variance of sample mean</span></span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected value:"</span>, <span class="fu">mean</span>(sim.xbar), <span class="st">"Variance:"</span>, <span class="fu">var</span>(sim.xbar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Expected value: 0.005180686   Variance: 0.1058328</code></pre>
</div>
</div>
<div style="font-size: 0.51em">
<p><br></p>
</div>
<p>These are very close to the theoretical values: <span class="math inline">\quad {\rm I\kern-.3em E}[\overline{X}] = 0 \,, \quad {\rm Var}[\overline{X}] = \frac{1}{10} = 0.1</span></p>
</section>
<section id="example-sample-mean-vs-sample-median" class="slide level2 smaller">
<h2>Example: Sample mean VS sample median</h2>
<ul>
<li><p>Both sample mean and median can be used to estimate the center of a distribution</p></li>
<li><p>But which one is better?</p></li>
<li><p>Suppose the population is <span class="math inline">N(\mu,\sigma^2)</span></p></li>
<li><p>We know that the sample mean <span class="math inline">\overline{X}</span> satisfies <span class="math display">
{\rm I\kern-.3em E}[\overline{X}] = \mu \,, \qquad {\rm Var}[\overline{X}] = \frac{\sigma^2}{n}
</span></p></li>
<li><p>However, no such formulas are available for the sample meadian</p></li>
</ul>
<p><strong>Question:</strong> How can we compare them? Use simulation</p>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<p>To simulate sample mean and median from <span class="math inline">N(0,1)</span>, we do:</p>
<ul>
<li><p>Generate sample <span class="math inline">x_1, \ldots, x_{10}</span> from <span class="math inline">N(0,1)</span>, and compute sample mean and median</p></li>
<li><p>Repeat <span class="math inline">M = 1000</span> times</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span>; n <span class="ot">&lt;-</span> <span class="dv">10</span>  </span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a>sim.mean <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">mean</span>(<span class="fu">rnorm</span>(n)))</span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a>sim.median <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">median</span>(<span class="fu">rnorm</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>To compare simulated sample mean and median, we can produce a boxplot</p></li>
<li><p>The one with smallest variance, will be the better estimator for the true population mean <span class="math inline">\mu = 0</span></p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">list</span>(<span class="st">"sample mean"</span> <span class="ot">=</span> sim.mean, </span>
<span id="cb8-2"><a aria-hidden="true" tabindex="-1"></a>             <span class="st">"sample median"</span> <span class="ot">=</span> sim.median),</span>
<span id="cb8-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Normal population N(0,1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-4" class="slide level2 smaller">
<h2></h2>

<img data-src="appendix_C_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"><ul>
<li>The sample mean has less variability</li>
<li>It is the preferred estimator for the true population mean<br>
(when the population is normal)</li>
</ul>
</section>
<section id="example-computing-probabilities" class="slide level2 smaller">
<h2>Example: Computing probabilities</h2>
<p><strong>Question:</strong> What is the probability of rolling <span class="math inline">7</span> with two dice?</p>
<ul>
<li><p>Of course this problem has combinatorial answer: <span class="math inline">p = \frac16</span></p></li>
<li><p>But we can also answer using simulation</p></li>
<li><p>To simulate the roll of a dice, we use the function <code>sample</code></p>
<ul>
<li><code>sample(x, n, replace = T)</code></li>
<li>samples n times from vector <code>x</code> with replacement</li>
</ul></li>
<li><p>To roll 2 dice, we input:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Roll two dice</span></span>
<span id="cb9-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>, <span class="at">replace =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1</code></pre>
</div>
</div>
</section>
<section id="section-5" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.94em">
<p>To compute the probability of rolling <span class="math inline">7</span> with two dice we do:</p>
<ul>
<li>Simulate one roll of the two dice, and sum the outcome</li>
<li>Repeat <span class="math inline">M = 1000</span> times</li>
<li>Estimate the probability of rolling a <span class="math inline">7</span> with <span class="math display">
P(\text{Rolling } 7) \approx \frac{\# \text{ of times the simulated roll is } 7 }{1000}
</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a>sim.rolls <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">sum</span>( <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>, <span class="at">replace =</span> T) ))</span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a aria-hidden="true" tabindex="-1"></a>number.of<span class="fl">.7</span>s <span class="ot">&lt;-</span> <span class="fu">sum</span>( sim.rolls <span class="sc">==</span> <span class="dv">7</span> )</span>
<span id="cb11-6"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> number.of<span class="fl">.7</span>s <span class="sc">/</span> M</span>
<span id="cb11-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The estimated probability of rolling 7 is"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The estimated probability of rolling 7 is 0.166</code></pre>
</div>
</div>
<ul>
<li>This is very close to the theoretical probability <span class="math inline">p = 1/6</span></li>
</ul>
</div>
</section>
<section id="example-interpretation-of-confidence-intervals" class="slide level2 smaller">
<h2>Example: Interpretation of Confidence Intervals</h2>
<ul>
<li><p>Suppose given a normal population <span class="math inline">N(\mu,\sigma^2)</span></p></li>
<li><p>A <span class="math inline">95 \%</span> conﬁdence interval for the true mean <span class="math inline">\mu</span> is a (random) interval <span class="math inline">[a,b]</span> s.t. <span class="math display">
P(\mu \in [a,b]) = 0.95
</span></p></li>
<li><p>Confidence interval is <strong>not</strong> probability statement about <span class="math inline">\mu</span> – note <span class="math inline">\mu</span> is a constant!</p></li>
<li><p>It is probability statement about <span class="math inline">[a,b]</span></p></li>
</ul>
<p><strong>Interpretation:</strong> The random interval <span class="math inline">[a,b]</span> contains the mean <span class="math inline">\mu</span> with probability <span class="math inline">0.95</span></p>
</section>
<section id="section-6" class="slide level2 smaller">
<h2></h2>
<p><strong>Constructing the confidence interval with t-statistic:</strong></p>
<ul>
<li><p>Suppose given a sample <span class="math inline">x_1, \ldots, x_n</span> from <span class="math inline">N(\mu,\sigma^2)</span></p></li>
<li><p>Recall: the t-statistic has t-distribution <span class="math display">
t = \frac{\overline{x}-\mu}{\mathop{\mathrm{e.s.e.}}} \, \sim  \, t_{n-1} \,, \qquad \mathop{\mathrm{e.s.e.}}= \frac{s}{\sqrt{n}}
</span></p></li>
<li><p>We impose that <span class="math inline">t</span> is observed with probability <span class="math inline">0.95</span> <span class="math display">
P(- t^* \leq t \leq t^*) = 0.95 \,, \qquad
t^* = t_{n-1}(0.025)
</span></p></li>
<li><p>The <span class="math inline">95\%</span> confidence interval is obtained by solving above equation for <span class="math inline">\mu</span> <span class="math display">
P(\mu \in [a,b] ) = 0.95 \,, \qquad
a = \overline{x} - t^* \times \mathop{\mathrm{e.s.e.}}, \qquad  
b = \overline{x} + t^* \times \mathop{\mathrm{e.s.e.}}
</span></p></li>
<li><p><strong>Interpretation:</strong> If you sample over and over again, the interval <span class="math inline">[a,b]</span> will contain <span class="math inline">\mu</span> about <span class="math inline">95\%</span> of the times</p></li>
</ul>
</section>
<section id="section-7" class="slide level2 smaller">
<h2></h2>

<img data-src="images/CI_interpretation.png" style="width:100.0%" class="r-stretch"><div style="font-size: 0.85em">
<ul>
<li><p>Each row of points is a sample from the same normal distribution <span class="math inline">\qquad</span> (Image from <a href="https://en.wikipedia.org/wiki/Confidence_interval#/media/File:Normal_distribution_50%25_CI_illustration.svg">Wikipedia</a>)</p></li>
<li><p>The colored lines are confidence intervals for the mean <span class="math inline">\mu</span></p></li>
<li><p>At the center of each interval is the sample mean (diamond)</p></li>
<li><p>The blue intervals contain the population mean, and the red ones do not</p></li>
</ul>
</div>
</section>
<section id="section-8" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.92em">
<p><strong>Simulating one confidence interval in R:</strong></p>
<ul>
<li>Sample <span class="math inline">n = 100</span> times from <span class="math inline">N(0,1)</span>
<ul>
<li>Running a t-test on the sample gives a confidence interval for the unknown mean <span class="math inline">\mu</span></li>
<li>The confidence interval can be retrieved with <code>$conf.int</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 100 times from N(0,1)</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confidence interval using t.test</span></span>
<span id="cb13-5"><a aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>interval</code> is a vector containing the simulated confidence interval
<ul>
<li>Left extreme in <code>interval[1]</code> <span class="math inline">\qquad</span> Right extreme in <code>interval[2]</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> interval[<span class="dv">1</span>];   b <span class="ot">&lt;-</span> interval[<span class="dv">2</span>]</span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Simulated confidence interval: a ="</span>, a, <span class="st">"  b = "</span>, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Simulated confidence interval: a = -0.2262375   b =  0.1689576</code></pre>
</div>
</div>
<ul>
<li>In this case the interval contains the true mean <span class="math inline">\mu = 0</span></li>
</ul>
</div>
</section>
<section id="section-9" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.96em">
<p><strong>Testing the claim:</strong> <span class="math inline">\quad P (\mu \in [a,b]) = 0.95</span></p>
<ul>
<li><em>If you sample over and over, the interval <span class="math inline">[a,b]</span> will contain <span class="math inline">\mu</span> about <span class="math inline">95\%</span> of the times</em></li>
</ul>
<p>We test with the following method:</p>
<ul>
<li><p>Sample <span class="math inline">n = 100</span> times from <span class="math inline">N(0,1)</span> and compute confidence interval</p></li>
<li><p>Repeat <span class="math inline">M = 1000</span> times</p></li>
<li><p>Check how many times <span class="math inline">\mu = 0</span> belongs to simulated confidence intervals</p></li>
<li><p>Estimate the probability of the CI containing <span class="math inline">\mu</span> as <span class="math display">
P(\mu \in [a,b]) \approx \frac{\# \text{ of times } \mu = 0 \text{ belongs to simulated } [a,b]}{M}
</span></p></li>
<li><p>The estimate should approach <span class="math inline">0.95</span></p></li>
</ul>
</div>
</section>
<section id="section-10" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.96em">
<ul>
<li>First, we simulate the <span class="math inline">M = 1000</span> confidence intervals</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate M confidence intervals for the mean</span></span>
<span id="cb16-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>; M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">t.test</span>(<span class="fu">rnorm</span>(n)) <span class="sc">$</span> conf.int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>intervals</code> is a matrix containing the <span class="math inline">M = 1000</span> simulated intervals (as columns)
<ul>
<li>Left extremes are in <code>intervals[1, ]</code></li>
<li>Right extremes are in <code>intervals[2, ]</code></li>
</ul></li>
<li>For visualization, we print the first 5 confidence intervals</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first 5 columns of intervals</span></span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>intervals[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]        [,2]       [,3]       [,4]        [,5]
[1,] -0.2262375 -0.07222545 -0.2428610 -0.1788659 -0.07420973
[2,]  0.1689576  0.35116698  0.1201007  0.2189942  0.30661995</code></pre>
</div>
</div>
</div>
</section>
<section id="section-11" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.9em">
<ul>
<li><p>Now, we have our <span class="math inline">M = 1000</span> confidence intervals for <span class="math inline">\mu = 0</span></p></li>
<li><p>Check how many times <span class="math inline">\mu = 0</span> belongs to simulated confidence intervals</p></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Save left and right extremes in vectors</span></span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> intervals[<span class="dv">1</span>, ];   b <span class="ot">&lt;-</span> intervals[<span class="dv">2</span>, ]</span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many times mu = 0 belongs to (a,b)</span></span>
<span id="cb19-5"><a aria-hidden="true" tabindex="-1"></a>mu.belongs <span class="ot">&lt;-</span> <span class="fu">sum</span>( (a <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (<span class="dv">0</span> <span class="sc">&lt;</span> b) )</span>
<span id="cb19-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the probability that mu = 0 belongs to (a,b)</span></span>
<span id="cb19-8"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> mu.belongs <span class="sc">/</span> M</span>
<span id="cb19-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"mu = 0 belongs to the confidence interval with probability"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>mu = 0 belongs to the confidence interval with probability 0.9494</code></pre>
</div>
</div>
<ul>
<li>This approximates the theoretical probability <span class="math display">
P(\mu \in [a,b]) = 0.95
</span> (we would need more confidence intervals for a better estimate)</li>
</ul>
</div>
</section></section>
<section>
<section id="part-2-simulating-p-values" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Simulating p-values</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="the-problem-of-simulating-p-values" class="slide level2 smaller">
<h2>The problem of simulating p-values</h2>
<p>Suppose given a random variable <span class="math inline">X</span> such that</p>
<ul>
<li><p>The distribution of <span class="math inline">X</span> is (possibly) unknown</p></li>
<li><p>A method for <strong>simulating</strong> <span class="math inline">X</span> is available</p>
<ul>
<li>This means we can (somehow) sample values from <span class="math inline">X</span></li>
</ul></li>
</ul>
<p><strong>Goal:</strong> For a given <span class="math inline">x^*</span>, we want to estimate the p-value</p>
<p><span class="math display">
p = P(X &gt; x^*)
</span></p>
</section>
<section id="general-recipe-to-simulate-p-values" class="slide level2 smaller">
<h2>General recipe to simulate p-values</h2>
<p><strong>Goal:</strong> Estimate the p-value <span class="math inline">p = P(X&gt;x^*)</span></p>
<ol type="1">
<li><p>Simuate the random varible <span class="math inline">X</span>. You obtain a numerical value <span class="math inline">X_{\rm sim}</span></p></li>
<li><p>The simulated value is <strong>extreme</strong> if <span class="math display">
X_{\rm sim} &gt; x^*
</span></p></li>
<li><p>There are two possibilities:</p>
<ul>
<li><span class="math inline">X_{\rm sim}</span> is extreme <span class="math inline">\quad \,\,\, \quad \implies \quad</span> simulation goes in favor of <span class="math inline">\, p</span></li>
<li><span class="math inline">X_{\rm sim}</span> is not extreme <span class="math inline">\quad \implies \quad</span> simulation goes in favor of <span class="math inline">\, 1-p</span></li>
</ul></li>
<li><p>We <strong>estimate</strong> the p-value as <span class="math display">
p =  P( X &gt; x^* ) \ \approx \ \frac{ \# \text{ of extreme simulated values} }{ \text{Total number of simulations} }
</span></p></li>
</ol>
</section>
<section id="example-monte-carlo-p-value-for-goodness-of-fit-test" class="slide level2 smaller">
<h2>Example: Monte Carlo p-value for goodness-of-fit test</h2>
<p><strong>Goal:</strong> use Monte Carlo simulations to compute p-value for <strong>goodness-of-fit</strong> test</p>
<ul>
<li>Consider data counts</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed counts</td>
<td style="text-align: center;"><span class="math inline">o_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_n</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Null Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1^0</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n^0</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The expected counts are <span class="math inline">E_i = m p_i^0</span></p></li>
<li><p>Under the null hypothesis, the observed counts <span class="math inline">(o_1, \ldots, o_n)</span> come from <span class="math display">
(O_1 , \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)
</span></p></li>
</ul>
</section>
<section id="p-value-for-goodness-of-fit-test" class="slide level2 smaller">
<h2>p-value for goodness-of-fit test</h2>
<ul>
<li><p>The chi-squared statistic <em>random variable</em> is <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i }
</span></p></li>
<li><p>The observed chi-squared statistics is <span class="math display">
\chi^2_{\rm obs} = \sum_{i=1}^n \frac{(o_i - E_i)^2 }{ E_i }
</span></p></li>
<li><p>The p-value is defined as <span class="math display">
p = P( \chi^2 &gt; \chi^2_{\rm obs} )
</span></p></li>
</ul>
</section>
<section id="problem-computing-p-value-for-low-counts" class="slide level2 smaller">
<h2>Problem: Computing p-value for low counts</h2>
<ul>
<li><p>Suppose <span class="math inline">E_i &lt; 5</span> for some <span class="math inline">i</span></p></li>
<li><p>In this case, <span class="math inline">\chi^2</span> is <strong>not</strong> <span class="math inline">\chi^2_{n-1}</span> distributed</p></li>
<li><p>In fact, the distribution is <strong>unknown</strong> <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i }  \ \, \sim \ \, ???
</span></p></li>
<li><p>If the distribution is unknown, how do we compute the p-value <span class="math display">
p = P( \chi^2 &gt; \chi^2_{\rm obs} )  \ \ ???
</span></p></li>
</ul>
<p><strong>Exercise</strong>: Come up with a simulation to approximate <span class="math inline">p</span></p>
</section>
<section id="method-simulating-p-value-for-chi2-statistic" class="slide level2 smaller">
<h2>Method: Simulating p-value for <span class="math inline">\chi^2</span> statistic</h2>
<div style="font-size: 0.94em">
<ol type="1">
<li><p>Simulate counts <span class="math inline">(o_1^{\rm sim},\ldots,o_n^{\rm sim})</span> from <span class="math inline">\mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)</span></p></li>
<li><p>Compute the corresponding simulated chi-squared statistic <span class="math display">
\chi^2_{\rm sim} = \sum_{i=1}^n \frac{ (o_i^{\rm sim} - E_i)^2 }{E_i} \,, \qquad E_i := m p_i^0
</span></p></li>
<li><p>The simulated chi-squared statistic is <strong>extreme</strong> if <span class="math display">
\chi^2_{\rm sim} &gt; \chi^2_{\rm obs} \,, \quad \text{ where \, } \chi^2_{\rm obs} = \sum_{i=1}^n \frac{(o_i - E_i)^2 }{ E_i } \,, \,\, o_i \, \text{ the observed counts}
</span></p></li>
<li><p>We <strong>estimate</strong> the theoretical p-value by <span class="math display">
p =  P( \chi^2 &gt; \chi^2_{\rm obs} ) \ \approx \ \frac{ \# \text{ of extreme simulated statistics} }{ \text{Total number of simulations} }
</span></p></li>
</ol>
</div>
</section>
<section id="exercise" class="slide level2 smaller">
<h2>Exercise</h2>
<div style="font-size: 0.94em">
<p><strong>Data:</strong> Number of defects in printed circuit boards, along with null probabilities</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"># Defects</th>
<th style="text-align: center;"><span class="math inline">0</span></th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Counts</strong></td>
<td style="text-align: center;"><span class="math inline">32</span></td>
<td style="text-align: center;"><span class="math inline">15</span></td>
<td style="text-align: center;"><span class="math inline">9</span></td>
<td style="text-align: center;"><span class="math inline">4</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Null Probabilities</strong></td>
<td style="text-align: center;"><span class="math inline">0.5</span></td>
<td style="text-align: center;"><span class="math inline">0.3</span></td>
<td style="text-align: center;"><span class="math inline">0.15</span></td>
<td style="text-align: center;"><span class="math inline">0.05</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Total number of counts is <span class="math inline">m = 60</span>. Expected counts are <span class="math inline">E_i = m p_i^0</span></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">E_1</span></th>
<th style="text-align: center;"><span class="math inline">E_2</span></th>
<th style="text-align: center;"><span class="math inline">E_3</span></th>
<th style="text-align: center;"><span class="math inline">E_4</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">30</span></td>
<td style="text-align: center;"><span class="math inline">18</span></td>
<td style="text-align: center;"><span class="math inline">9</span></td>
<td style="text-align: center;"><span class="math inline">3</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Note:</strong> <span class="math inline">E_4 = 3 &lt; 5 \quad \implies \quad</span> the distribution of <span class="math inline">\chi^2</span> is unknown</p></li>
<li><p><strong>Exercise</strong>: Write R code to perform a goodness-of-fit test on above data</p>
<ul>
<li>You may not use the function <code>chisq.test</code></li>
<li>p-value should be simulated (see previous slide)</li>
</ul></li>
</ul>
</div>
</section>
<section id="solution" class="slide level2 smaller">
<h2>Solution</h2>
<ul>
<li>First, compute the observed chi-squared statistic:
<ul>
<li>Enter observed counts and null probabilities</li>
<li>Compute total counts, expected counts and <span class="math inline">\chi^2_{\rm obs}</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">15</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a>null.p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>)</span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute total counts</span></span>
<span id="cb21-6"><a aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts)</span>
<span id="cb21-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute expected counts</span></span>
<span id="cb21-9"><a aria-hidden="true" tabindex="-1"></a>exp.counts <span class="ot">&lt;-</span> m <span class="sc">*</span> null.p</span>
<span id="cb21-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the observed chi-squared statistic</span></span>
<span id="cb21-12"><a aria-hidden="true" tabindex="-1"></a>obs.chi <span class="ot">&lt;-</span> <span class="fu">sum</span>( (counts <span class="sc">-</span> exp.counts)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp.counts )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-12" class="slide level2 smaller">
<h2></h2>
<p>We now generate <span class="math inline">M = 10000</span> simulated chi-squared statistics:</p>
<ol type="1">
<li><p>Simulate counts <span class="math inline">(o_1^{\rm sim},\ldots,o_n^{\rm sim})</span> from <span class="math inline">\mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)</span></p></li>
<li><p>Compute the corresponding simulated chi-squared statistic <span class="math display">
\chi^2_{\rm sim} = \sum_{i=1}^n \frac{ (o_i^{\rm sim} - E_i)^2 }{E_i}
</span></p></li>
</ol>
<div style="font-size: 0.94em">
<div class="sourceCode" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate M chi-squared statistics</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a aria-hidden="true" tabindex="-1"></a>sim.chi <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, {</span>
<span id="cb22-5"><a aria-hidden="true" tabindex="-1"></a>                <span class="co"># Simulate multinomial counts under null hypothesis</span></span>
<span id="cb22-6"><a aria-hidden="true" tabindex="-1"></a>                sim.counts <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="dv">1</span>, m, null.p)</span>
<span id="cb22-7"><a aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb22-8"><a aria-hidden="true" tabindex="-1"></a>                <span class="co"># Return chi-squared statistic from the simulated counts</span></span>
<span id="cb22-9"><a aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum</span>( (sim.counts <span class="sc">-</span> exp.counts )<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp.counts)</span>
<span id="cb22-10"><a aria-hidden="true" tabindex="-1"></a>                })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-13" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The vector <code>sim.chi</code> contains <span class="math inline">M = 10000</span> simulated chi-squared statistics</p></li>
<li><p>We approximate the p-value by <span class="math display">
p = P(\chi^2 &gt; \chi_{\rm obs}^2) \approx
\ \frac{ \# \text{ of extreme simulated statistics} }{ M }
</span></p></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many simulated statistics are extreme</span></span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a>num.extreme <span class="ot">&lt;-</span> <span class="fu">sum</span>( sim.chi <span class="sc">&gt;</span> obs.chi )</span>
<span id="cb23-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the p-value</span></span>
<span id="cb23-5"><a aria-hidden="true" tabindex="-1"></a>sim.p.value <span class="ot">&lt;-</span> num.extreme <span class="sc">/</span> M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-14" class="slide level2 smaller">
<h2></h2>
<ul>
<li>As cross check, we also simulate the p-value with <code>chisq.test</code></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test using built-in R function</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null.p, <span class="at">simulate.p.value =</span> T)</span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value from chi-squared test result</span></span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a>R.p.value <span class="ot">&lt;-</span> ans<span class="sc">$</span>p.value</span>
<span id="cb24-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-values for comparison</span></span>
<span id="cb24-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Our simulated p-value is:"</span>, sim.p.value)</span>
<span id="cb24-9"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R simulated p-value is:"</span>, R.p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Our simulated p-value is: 0.8169</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
R simulated p-value is: 0.8195902</code></pre>
</div>
</div>
<div style="font-size: 0.51em">
<p><br></p>
</div>
<ul>
<li><p><strong>Note</strong>: The simulated p-values are the same! (up to random fluctuations)</p></li>
<li><p><strong>Conclusion:</strong> We see that <span class="math inline">p &gt; 0.05</span>. There is not enough evidence to reject <span class="math inline">H_0</span></p></li>
</ul>
</section></section>
<section>
<section id="part-3-the-bootstrap" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>The Bootstrap</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="motivation" class="slide level2 smaller">
<h2>Motivation</h2>
<ul>
<li><p>So far, our simulations used knowledge of the population distribution, e.g.</p>
<ul>
<li>To simulate <span class="math inline">\pi</span>, we sampled points from <span class="math inline">{\rm Uniform}([-1,1] \times [-1,1])</span></li>
<li>To simulate the <span class="math inline">\chi^2</span> statistic, we sampled <em>Multinomial</em> counts</li>
<li>To simulate confidence intervals, we sampled from a normal population</li>
</ul></li>
<li><p><strong>Problem:</strong> Sometimes the population distribution <span class="math inline">f</span> is <strong>unknown</strong></p></li>
<li><p><strong>Bootstrap:</strong> Replace the unknown distribution <span class="math inline">f</span> with a known distribution <span class="math inline">\hat{f}</span></p></li>
</ul>
</section>
<section id="the-sample-distribution" class="slide level2 smaller">
<h2>The Sample Distribution</h2>
<div style="font-size: 0.94em">
<ul>
<li><p>Assume given a sample <span class="math inline">x_1,\ldots,x_n</span> from a population <span class="math inline">f</span></p></li>
<li><p>The <strong>Sample Distribution</strong> is the discrete distribution which puts mass <span class="math inline">\frac1n</span> at each sample point <span class="math display">
\hat{f}(x) =
\begin{cases}
\frac1n  &amp; \quad \text{ if } \, x \in \{x_1, \ldots, x_n\} \\
0        &amp; \quad \text{ otherwise }
\end{cases}
</span></p></li>
</ul>
<div id="glivenko-cantelli" class="Theorem" title="Glivenko-Cantelli">
<p></p><details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem: </strong>Glivenko-Cantelli</summary><div>As the sample size increases <span class="math display">
\lim_{n \to \infty} \hat{f} = f
</span><p></p>
</div></details>
</div>
<p>(more precisely, the convergence is uniform almost everywhere wrt the cdfs: <span class="math inline">\hat{F} \to F</span>)</p>
</div>
</section>
<section id="main-bootstrap-idea" class="slide level2 smaller">
<h2>Main Bootstrap idea</h2>
<p><strong>Setting:</strong> Assume given the <strong>original</strong> sample <span class="math inline">x_1,\ldots,x_n</span> from unknown population <span class="math inline">f</span></p>
<p><strong>Bootstrap:</strong> Regard the sample as the <strong>whole population</strong></p>
<ul>
<li><p>Replace the unknown distribution <span class="math inline">f</span> with the sample distribution <span class="math display">
\hat{f}(x) =
\begin{cases}
\frac1n  &amp; \quad \text{ if } \, x \in \{x_1, \ldots, x_n\} \\
0        &amp; \quad \text{ otherwise }
\end{cases}
</span></p></li>
<li><p>Any sampling will be done from <span class="math inline">\hat{f}</span> <span class="math inline">\qquad \quad</span> (motivated by Glivenko-Cantelli Thm)</p></li>
</ul>
<p><strong>Note:</strong> <span class="math inline">\hat{f}</span> puts mass <span class="math inline">\frac1n</span> at each sample point</p>
<p><strong>Drawing an observation from <span class="math inline">\hat f</span> is equivalent to drawing one point at random from the original sample <span class="math inline">\{x_1,\ldots,x_n\}</span></strong></p>
</section>
<section id="the-bootstrap-algorithm" class="slide level2 smaller">
<h2>The Bootstrap Algorithm</h2>
<div style="font-size: 0.94em">
<p><strong>Setting:</strong> Given the <strong>original</strong> sample <span class="math inline">x_1,\ldots,x_n</span> from unknown population <span class="math inline">f</span></p>
<p><strong>Bootstrap Algorithm:</strong> to estimate the distribution of a statistic of interest <span class="math inline">T</span></p>
<ol type="1">
<li><p>Draw sample <span class="math inline">x_1^*,\ldots,x_n^*</span> from <span class="math inline">\{x_1, \ldots, x_n\}</span> with <strong>replacement</strong></p></li>
<li><p>Compute the statistic <span class="math inline">T</span> on the bootstrap sample <span class="math display">
T^* = T(x_1^*,\ldots,x_n^*)
</span></p></li>
<li><p>Repeat Steps 1 and 2, <span class="math inline">B</span> times, to get <span class="math inline">B</span> bootstrap simulations of <span class="math inline">T</span> <span class="math display">
T^*_1, \ldots , T^*_B
</span> These values represent the <strong>bootstrap distribution</strong> of <span class="math inline">T</span></p></li>
</ol>
<p><strong>Note</strong>: If population distribution <span class="math inline">f</span> is known, we would just sample from <span class="math inline">f</span></p>
</div>
</section>
<section id="section-15" class="slide level2 smaller">
<h2></h2>

<img data-src="images/bootstrap.png" style="width:100.0%" class="r-stretch"><div style="font-size: 0.89em">
<p><br></p>
<ul>
<li><p>Original sample <span class="math inline">\{x_1,\ldots,x_n\}</span> is drawn from the population <span class="math inline">\qquad</span> (Image from <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)#/media/File:Illustration_bootstrap.svg">Wikipedia</a>)</p></li>
<li><p>Resamples <span class="math inline">\{x_1^*,\ldots,x_n^*\}</span> are generated by drawing from <span class="math inline">\{x_1,\ldots,x_n\}</span> with <strong>replacement</strong></p></li>
<li><p>Note: Data points <span class="math inline">x_i</span> can be drawn more than once (in red and sligthly offsetted)</p></li>
<li><p>For each resample, the statistic <span class="math inline">T^*</span> is calculated</p></li>
<li><p>Therefore, a histogram can be calculated to estimate the bootstrap distribution of <span class="math inline">T</span></p></li>
</ul>
</div>
</section>
<section id="q-a" class="slide level2 smaller">
<h2>Q &amp; A</h2>
<div style="font-size: 0.93em">
<p><strong>References?</strong></p>
<ul>
<li><p>Simulation and bootstrap are huge topics</p></li>
<li><p>Good introduction: the book by Efron (inventor of bootstrap) and Tibshirani <span class="citation" data-cites="efron">[<a href="#/references" role="doc-biblioref" onclick="">1</a>]</span></p></li>
</ul>
<p><strong>Why is the Bootstrap useful?</strong></p>
<ul>
<li><p>Because a lot of the times population distribution is unknown</p></li>
<li><p>Despite this, bootstrap allows to do inference on statistic <span class="math inline">T</span></p></li>
</ul>
<p><strong>Why does the Bootstrap work?</strong> We are just resampling from the original sample!</p>
<ul>
<li><p>It (often) works because the original sample encodes population variability</p></li>
<li><p>By resampling the original sample, we are simulating this variability</p></li>
</ul>
</div>
</section>
<section id="q-a-1" class="slide level2 smaller">
<h2>Q &amp; A</h2>
<div style="font-size: 0.93em">
<p><strong>How good is the bootstrap distribution of <span class="math inline">T</span>?</strong></p>
<ul>
<li>It can be a good approximation of the true distribution of <span class="math inline">T</span> when the<br>
<strong>original sample is sufficiently variable</strong>
<ul>
<li>Things tend to go well for large samples (<span class="math inline">n \geq 50</span>)</li>
</ul></li>
<li>Bootstrap works well when the statistic <span class="math inline">T</span> is a mean (or something like a mean)
<ul>
<li>for example median, regression coefficient, or standard deviation.</li>
</ul></li>
<li>The bootstrap has difficulties when the statistic <span class="math inline">T</span> is influenced by outliers
<ul>
<li>for example if <span class="math inline">T</span> is the range, that is, <span class="math inline">T =</span> max value <span class="math inline">-</span> min value</li>
</ul></li>
</ul>
</div>
</section>
<section id="q-a-2" class="slide level2 smaller">
<h2>Q &amp; A</h2>
<div style="font-size: 0.93em">
<p><strong>What are the limitations of bootstrap?</strong></p>
<ul>
<li>Computationally expensive
<ul>
<li>For decent simulation of bootstrap distribution of <span class="math inline">T</span>, need at least<br>
<span class="math inline">B = 10,000</span> resamples (<span class="math inline">100,000</span> would be better!)</li>
</ul></li>
<li>Relies on a sufficiently variable original sample
<ul>
<li>If the original sample is not good, the bootstrap cannot recover from this problem</li>
<li>In this case the bootstrap population will not look like the true population</li>
<li>The bootstrap resampling will not be useful</li>
</ul></li>
<li>No way to determine if the original sample is good enough</li>
</ul>
<p><strong>However, problems are usually mitigated by large enough original sample (<span class="math inline">n \geq 50</span>)</strong></p>
</div>
</section>
<section id="example-bootstrapping-the-mean" class="slide level2 smaller">
<h2>Example: Bootstrapping the mean</h2>
<div style="font-size: 0.91em">
<p><strong>Setting:</strong> Given the <strong>original</strong> sample <span class="math inline">x_1,\ldots,x_n</span> from unknown population <span class="math inline">f</span></p>
<p><strong>Bootstrap Algorithm:</strong> to estimate the distribution of the sample mean <span class="math inline">\overline{X}</span></p>
<ol type="1">
<li><p>Draw sample <span class="math inline">x_1^*,\ldots,x_n^*</span> from <span class="math inline">\{x_1, \ldots, x_n\}</span> with <strong>replacement</strong></p></li>
<li><p>Compute the sample mean <span class="math inline">\overline{X}</span> on the bootstrap sample <span class="math display">
\overline{X}^* = \frac{1}{n} \sum_{i=1}^n x_i^*
</span></p></li>
<li><p>Repeat Steps 1 and 2, <span class="math inline">B</span> times, to get <span class="math inline">B</span> bootstrap simulations of <span class="math inline">\overline{X}^*</span> <span class="math display">
\overline{X}^*_1, \ldots , \overline{X}^*_B
</span> These values represent the <strong>bootstrap distribution</strong> of <span class="math inline">\overline{X}</span></p></li>
</ol>
</div>
</section>
<section id="implementation-in-r" class="slide level2 smaller">
<h2>Implementation in R</h2>
<div style="font-size: 0.94em">
<ul>
<li>Store the original sample into a vector and compute length</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store original sample and compute length</span></span>
<span id="cb27-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(x_1, ..., x_n)</span>
<span id="cb27-4"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>To generate one bootstrap simulation of <span class="math inline">\overline{X}</span>:
<ol type="1">
<li>Sample n times from <span class="math inline">\{x_1,\ldots,x_n\}</span> with replacement</li>
<li>This gives the bootstrap sample <span class="math inline">\{x_1^*,\ldots,x_n^*\}</span></li>
<li>Compute sample mean of the bootstrap sample</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap sample mean one time</span></span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a>x.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)     <span class="co"># Sample n times with replacement</span></span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>xbar.star <span class="ot">&lt;-</span> <span class="fu">mean</span>(x.star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-16" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.94em">
<ul>
<li>To generate <span class="math inline">B = 10,000</span> bootstrap simulations of <span class="math inline">\overline{X}</span>, use <strong>replicate</strong></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap sample mean B = 10,000 times</span></span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a aria-hidden="true" tabindex="-1"></a>xbar.star <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb29-5"><a aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Generate bootstrap sample</span></span>
<span id="cb29-6"><a aria-hidden="true" tabindex="-1"></a>                       x.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-7"><a aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Return mean of bootstrap sample</span></span>
<span id="cb29-8"><a aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(x.star)</span>
<span id="cb29-9"><a aria-hidden="true" tabindex="-1"></a>                      })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The vector <code>xbar.star</code> contains <span class="math inline">B = 10,000</span> bootstrap samples of <span class="math inline">\overline{X}</span></li>
</ul>
<p><strong>Why is this useful?:</strong> When the population is normal <span class="math inline">N(\mu,\sigma^2)</span>, we know that <span class="math display">
\overline{X} \sim N(\mu, \sigma^2/n)
</span> However: population distribution unknown <span class="math inline">\implies</span> distribution of <span class="math inline">\overline{X}</span> unknown</p>
<p><strong>Bootstrap gives a way to estimate distribution of <span class="math inline">\overline{X}</span></strong></p>
</div>
</section>
<section id="worked-example" class="slide level2 smaller">
<h2>Worked Example</h2>
<div style="font-size: 0.90em">
<p><strong>Original sample:</strong> CEOs compensation in 2012 (USA data - in million dollars)</p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CEO Pay 2012</strong></td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">3.2</td>
</tr>
</tbody>
</table>
<p><strong>We want to simulate the bootstrap distribution of the sample mean <span class="math inline">\overline{X}</span></strong></p>
<ul>
<li>To do so, we generate <span class="math inline">B = 10,000</span> bootstrap simulations of sample mean <span class="math inline">\overline{X}</span></li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter original sample and compute size</span></span>
<span id="cb30-2"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">23.5</span>, <span class="fl">6.4</span>, <span class="fl">11.1</span>, <span class="fl">3.8</span>, <span class="fl">8.9</span>, <span class="fl">4.8</span>, <span class="fl">23.8</span>, <span class="dv">3</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb30-3"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb30-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap sample mean B = 10,000 times</span></span>
<span id="cb30-6"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb30-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a aria-hidden="true" tabindex="-1"></a>xbar.star <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb30-9"><a aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Generate bootstrap sample</span></span>
<span id="cb30-10"><a aria-hidden="true" tabindex="-1"></a>                       x.star <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-11"><a aria-hidden="true" tabindex="-1"></a>                       <span class="co"># Return mean of bootstrap sample</span></span>
<span id="cb30-12"><a aria-hidden="true" tabindex="-1"></a>                       <span class="fu">mean</span>(x.star)</span>
<span id="cb30-13"><a aria-hidden="true" tabindex="-1"></a>                      })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-17" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.90em">
<ul>
<li><p>The vector <code>xbar.star</code> contains <span class="math inline">B = 10000</span> bootstrap samples from <span class="math inline">\overline{X}</span></p></li>
<li><p>We can examine the bootstrap distribution of <span class="math inline">\overline{X}</span> with a histogram</p>
<ul>
<li>If population was normal, we would expect <span class="math inline">\overline{X}</span> to be normal</li>
<li>However <span class="math inline">\overline{X}</span> is skewed to the right <span class="math inline">\implies</span> population might not be normal</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(xbar.star)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="appendix_C_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="section-18" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Plotting the density of <code>x</code> shows that the data is heavily skewed (not normal)</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<img data-src="appendix_C_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="part-4-bootstrap-ci" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br>Bootstrap CI</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="bootstrap-confidence-intervals" class="slide level2 smaller">
<h2>Bootstrap Confidence Intervals</h2>
<ul>
<li><p>When the population is normally distributed <span class="math inline">N(\mu,\sigma^2)</span>, we used the t-statistic <span class="math display">
t = \frac{\overline{x} - \mu}{\mathop{\mathrm{e.s.e.}}}
</span> to form a <span class="math inline">(1-\alpha)100\%</span> confidence interval <span class="math inline">[a,b]</span> for the population mean <span class="math inline">\mu</span> <span class="math display">
P(\mu \in [a,b]) = 1-\alpha \,, \quad
a, b = \overline{x} \mp t^* \times \mathop{\mathrm{e.s.e.}}, \quad  
t^* = t_{n-1}\left(\frac{\alpha}{2}\right)
</span></p></li>
<li><p>If the population is not normal, the interval <span class="math inline">[a,b]</span> might not be accurate, meaning that <span class="math display">
P(\mu \in [a,b]) \neq 1 - \alpha
</span></p></li>
<li><p>In this case, the bootstrap sample mean can be used to form a CI</p></li>
<li><p>Moreover, bootstrap CI easily generalize to any estimator <span class="math inline">T</span></p></li>
</ul>
</section>
<section id="algorithm-bootstrap-confidence-intervals" class="slide level2 smaller">
<h2>Algorithm: Bootstrap Confidence Intervals</h2>
<div style="font-size: 0.89em">
<p><strong>Setting:</strong> Given the <strong>original</strong> sample <span class="math inline">x_1,\ldots,x_n</span> from unknown population <span class="math inline">f</span>, and</p>
<ul>
<li><span class="math inline">\theta</span> population parameter <span class="math inline">\,\,</span> (e.g.&nbsp;<span class="math inline">\, \theta =</span> mean), <span class="math inline">\,\, T</span> estimator for <span class="math inline">\theta \,\,</span> (e.g.&nbsp;<span class="math inline">\, T =</span> sample mean)</li>
</ul>
<p><strong>Bootstrap CI Algorithm:</strong> to simulate <span class="math inline">(1-\alpha)100\%</span> CI for parameter <span class="math inline">\theta</span></p>
<ol type="1">
<li><p>Bootstrap <span class="math inline">B</span> times the statistic <span class="math inline">T</span>, obtaining the bootstrap simulations <span class="math inline">T^*_1, \ldots , T^*_B</span></p></li>
<li><p>Order the values <span class="math inline">T^*_1, \ldots , T^*_B</span> to obtain <span class="math display">
T^*_{(1)} \leq  \ldots  \leq T^*_{(B)}
</span></p></li>
<li><p>Let <span class="math inline">\, m = [(\alpha/2)B]</span>, where <span class="math inline">[\cdot]</span> is the ceiling function. The <strong>percentile bootstrap</strong> CI for <span class="math inline">\theta</span> is <span class="math display">
\left[  T^*_{(m)}  ,  T^*_{(B + 1- m)}  \right]
</span> Endpoints are <span class="math inline">\frac{\alpha}{2}100\%</span> and <span class="math inline">(1 − \frac{\alpha}{2})100\%</span> percentiles of sample distribution of <span class="math inline">T^*_1, \ldots , T^*_B</span></p></li>
</ol>
</div>
</section>
<section id="worked-example-1" class="slide level2 smaller">
<h2>Worked Example 1</h2>
<p><strong>Original sample:</strong></p>
<ul>
<li><p>A consumer group wishes to see whether the actual mileage of a new SUV matches the advertised 17 miles per gallon</p></li>
<li><p>To test the claim, the group fills the SUV’s tank and records the mileage</p></li>
<li><p>This is repeated 10 times. The results are below</p></li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>mpg</strong></td>
<td>11.4</td>
<td>13.1</td>
<td>14.7</td>
<td>14.7</td>
<td>15.0</td>
<td>15.5</td>
<td>15.6</td>
<td>15.9</td>
<td>16.0</td>
<td>16.8</td>
</tr>
</tbody>
</table>
<p><strong>We want to simulate <span class="math inline">95\%</span> bootstrap CI for the population mean <span class="math inline">\mu</span></strong></p>
</section>
<section id="section-19" class="slide level2 smaller">
<h2></h2>
<ul>
<li>First, we generate <span class="math inline">B = 10,000</span> bootstrap simulations of sample mean <span class="math inline">\overline{X}</span></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter original sample and compute size</span></span>
<span id="cb33-2"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">11.4</span>, <span class="fl">13.1</span>, <span class="fl">14.7</span>, <span class="fl">14.7</span>, <span class="fl">15.0</span>, <span class="fl">15.5</span>, <span class="fl">15.6</span>, <span class="fl">15.9</span>, <span class="fl">16.0</span>, <span class="fl">16.8</span>)</span>
<span id="cb33-3"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb33-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap sample mean B = 10,000 times</span></span>
<span id="cb33-6"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb33-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a aria-hidden="true" tabindex="-1"></a>xbar.star <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">mean</span>( <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>) ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-20" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The vector <code>xbar.star</code> contains <span class="math inline">B = 10000</span> bootstrap samples from <span class="math inline">\overline{X}</span></p></li>
<li><p>The <span class="math inline">(1-\alpha)\%</span> bootstrap CI for the population mean <span class="math inline">\mu</span> is <span class="math display">
\left[  \overline{X}^*_{(m)}  ,  \overline{X}^*_{(B + 1- m)}  \right]\,, \qquad m = [(\alpha/2)B]
</span></p></li>
<li><p>We have <span class="math inline">B = 10,000</span> and <span class="math inline">\alpha = 0.05 \quad \implies \quad m = 250</span></p></li>
<li><p>Therefore, the <span class="math inline">95\%</span> bootstrap CI for the population mean <span class="math inline">\mu</span> is <span class="math display">
\left[  \overline{X}^*_{(250)}  ,  \overline{X}^*_{(9751)}  \right]
</span></p></li>
<li><p>These percentiles can be automatically computed using the <code>quantile</code> function</p></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% CI from bootstrap samples</span></span>
<span id="cb34-2"><a aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb34-3"><a aria-hidden="true" tabindex="-1"></a>boot.CI <span class="ot">&lt;-</span> <span class="fu">quantile</span>(xbar.star, <span class="at">probs =</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-21" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.93em">
<ul>
<li>We compare the bootstrap CI to the usual t-statistic CI</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% t-statistic CI</span></span>
<span id="cb35-2"><a aria-hidden="true" tabindex="-1"></a>t.stat.CI <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int</span>
<span id="cb35-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb35-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap Confidence Interval (95%):"</span>, boot.CI)</span>
<span id="cb35-6"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">t-statistic Confidence Interval (95%):"</span>, t.stat.CI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div style="font-size: 0.15em">
<p><br></p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap Confidence Interval (95%): 13.86 15.71</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
t-statistic Confidence Interval (95%): 13.74545 15.99455</code></pre>
</div>
</div>
<div style="font-size: 0.15em">
<p><br></p>
</div>
<ul>
<li><p>The CI are almost overlapping</p></li>
<li><p>This is a very strong indication that the original population is normal</p>
<ul>
<li>Indeed, this is the case: You can verify it by plotting the density of <code>mpg</code></li>
</ul></li>
<li><p>The advertised 17 mpg do not fall in either CI. We have reason to doubt the claim</p></li>
<li><p>The code can be downloaded here <a href="codes/bootstrap_CI.R">bootstrap_CI.R</a></p></li>
</ul>
</div>
</section>
<section id="worked-example-2" class="slide level2 smaller">
<h2>Worked Example 2</h2>
<p><strong>Original sample:</strong> Compensation data for a sample of CEOs in 2012<br>
(USA data, in million dollars)</p>
<p><br></p>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CEO Pay 2012</strong></td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">3.2</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>We want to simulate <span class="math inline">95\%</span> bootstrap CI for the mean compensation <span class="math inline">\mu</span></strong></p>
</section>
<section id="section-22" class="slide level2 smaller">
<h2></h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a aria-hidden="true" tabindex="-1"></a>ceo12 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">23.5</span>, <span class="fl">6.4</span>, <span class="fl">11.1</span>, <span class="fl">3.8</span>, <span class="fl">8.9</span>, <span class="fl">4.8</span>, <span class="fl">23.8</span>, <span class="dv">3</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb38-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(ceo12))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<img data-src="appendix_C_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"><ul>
<li>Plotting the density of <code>ceo12</code>, we see that the data is not normal
<ul>
<li>Therefore, CI based on t-statistic would <strong>not be appropriate</strong></li>
<li>Need to compute a Bootstrap CI for <span class="math inline">\mu</span></li>
</ul></li>
</ul>
</section>
<section id="section-23" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Running the code <a href="codes/bootstrap_CI.R">bootstrap_CI.R</a> on the new data, we get</li>
</ul>
<div style="font-size: 0.15em">
<p><br></p>
</div>
<div class="cell">
<details class="code-fold">
<summary>View the R Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter original sample and compute size</span></span>
<span id="cb39-2"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">23.5</span>, <span class="fl">6.4</span>, <span class="fl">11.1</span>, <span class="fl">3.8</span>, <span class="fl">8.9</span>, <span class="fl">4.8</span>, <span class="fl">23.8</span>, <span class="dv">3</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb39-3"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb39-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap sample mean B = 10,000 times</span></span>
<span id="cb39-6"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb39-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a aria-hidden="true" tabindex="-1"></a>xbar.star <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">mean</span>( <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>) ))</span>
<span id="cb39-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% CI from bootstrap samples</span></span>
<span id="cb39-11"><a aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb39-12"><a aria-hidden="true" tabindex="-1"></a>boot.CI <span class="ot">&lt;-</span> <span class="fu">quantile</span>(xbar.star, <span class="at">probs =</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb39-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute 95% t-statistic CI</span></span>
<span id="cb39-15"><a aria-hidden="true" tabindex="-1"></a>t.stat.CI <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int</span>
<span id="cb39-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb39-18"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap Confidence Interval (95%):"</span>, boot.CI, </span>
<span id="cb39-19"><a aria-hidden="true" tabindex="-1"></a><span class="st">"</span><span class="sc">\n</span><span class="st">t-statistic Confidence Interval (95%):"</span>, t.stat.CI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap Confidence Interval (95%): 4.84 14.4005 
t-statistic Confidence Interval (95%): 3.339166 14.94083</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li><p>The bootstrap and t-statistic CI differ considerably, especially at low end</p></li>
<li><p>Bootstrap CI has to be preferred, due to non-normality of data</p></li>
</ul>
</section></section>
<section>
<section id="part-5-bootstrap-t-test" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br> Bootstrap t-test</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="motivation-1" class="slide level2 smaller">
<h2>Motivation</h2>
<div style="font-size: 0.93em">
<ul>
<li>Compensation data for a sample of CEOs in 2012 and 2013<br>
(USA data, in million dollars)</li>
</ul>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CEO Pay 2013</strong></td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">20.4</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>CEO Pay 2012</strong></td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">3.2</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Want to test for a difference in means via the t-statistic <span class="math display">
t =  \frac{\bar{x} -\bar{y}}{s_p\sqrt{\frac{1}{n}+\frac{1}{m}}} \,, \qquad
s_p = \sqrt{\frac{s^2_X(n-1)+s^2_Y(m-1)}{n+m-2}}
</span></p></li>
<li><p>Want to test for a difference in variance via the F-statistic <span class="math display">
F=\frac{s_X^2}{s_Y^2}
</span></p></li>
</ul>
</div>
</section>
<section id="motivation-2" class="slide level2 smaller">
<h2>Motivation</h2>
<div style="font-size: 0.93em">
<ul>
<li>Compensation data for a sample of CEOs in 2012 and 2013<br>
(USA data, in million dollars)</li>
</ul>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CEO Pay 2013</strong></td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">20.4</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>CEO Pay 2012</strong></td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">3.2</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Under assumptions of normality and independence of the populations, we have <span class="math display">
t \sim t_{n+m-2} \,, \qquad F \sim F_{n-1,m-1}
</span></p></li>
<li><p>This information allows to compute the exact p-values for the t and F tests <span class="math display">
p_t = 2 P( t_{n+m-2} &gt; |t| )  \,, \qquad p_F = 2P(F_{n-1,m-1} &gt; F  )
</span></p></li>
<li><p><strong>Question:</strong> What if we cannot assume normality? How do we compute p-values?</p></li>
<li><p><strong>Answer:</strong> Bootstrap p-values</p>
<ul>
<li>like simulated p-values, but sampling from the sample, instead of the population</li>
</ul></li>
</ul>
</div>
</section>
<section id="bootstrap-t-test-procedure" class="slide level2 smaller">
<h2>Bootstrap t-test procedure</h2>
<div style="font-size: 0.93em">
<ul>
<li><p>Suppose given two samples:</p>
<ul>
<li><span class="math inline">x_1, \ldots, x_n</span> from a population with cdf <span class="math inline">F(x)</span></li>
<li><span class="math inline">y_1, \ldots, y_m</span> from a population with cdf <span class="math inline">F(x - \Delta)</span></li>
</ul></li>
<li><p><strong>Note:</strong> Population distributions have the same shape</p>
<ul>
<li>Same spread, but they are shifted by <span class="math inline">\Delta \in \mathbb{R}</span></li>
</ul></li>
<li><p>Denoting by <span class="math inline">\mu_X</span> and <span class="math inline">\mu_Y</span> the means of <span class="math inline">F(x)</span> and <span class="math inline">F(x - \Delta)</span>, we have <span class="math display">
\Delta = \mu_X - \mu_Y
</span></p></li>
<li><p>We want to test for <strong>difference in means</strong> <span class="math display">
H_0 \colon \mu_X = \mu_Y \,, \quad \qquad
H_1 \colon \mu_X \neq \mu_Y , \quad \mu_X &lt; \mu_Y \,, \quad \text{ or } \quad  \mu_X &gt; \mu_Y
</span></p></li>
<li><p>We are not making assumptions on <span class="math inline">F \implies</span> distribution of t-statistic is unknown</p>
<ul>
<li>Need to bootstrap the t-statistic</li>
</ul></li>
</ul>
</div>
</section>
<section id="section-24" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p><strong>Assume the null hypothesis is true:</strong> <span class="math display">
\mu_X = \mu_Y  \quad \implies \quad \Delta = \mu_X - \mu_Y = 0
</span></p></li>
<li><p>Hence, under <span class="math inline">H_0</span>, the two samples come from the <strong>same population</strong> <span class="math inline">F</span></p></li>
<li><p>This means the two samples are actually part of a single sample of size <span class="math inline">n+m</span> <span class="math display">
\mathcal{S} = \{x_1, \ldots, x_n , y_1, \ldots, y_m \}
</span></p></li>
<li><p>The sample distribution <span class="math inline">\hat{F}</span> of <span class="math inline">\mathcal{S}</span> is an approximation of <span class="math inline">F</span><br>
(Glivenko-Cantelli Theorem)</p></li>
<li><p>We can therefore bootstrap the t-statistic from the combined sample <span class="math inline">\mathcal{S}</span></p></li>
</ul>
</section>
<section id="section-25" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The bootstrap samples are generated as follows:</p>
<ul>
<li>Sample <span class="math inline">\{x_1^*, \ldots, x_n^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</li>
<li>Sample <span class="math inline">\{y_1^*, \ldots, y_m^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</li>
</ul></li>
<li><p>Compute a bootstrap simulation of the t-statistic <span class="math display">
t^* =  \frac{\bar{x}^* -\bar{y}^*}{s_p\sqrt{\frac{1}{n}+\frac{1}{m}}} \,, \qquad
s_p = \sqrt{\frac{(s^2_X)^*(n-1)+(s^2_Y)^*(m-1)}{n+m-2}}
</span></p></li>
<li><p>Repeat <span class="math inline">B</span> times to obtain <span class="math display">
t^*_1, \ldots , t^*_B
</span></p></li>
<li><p>These values represent the <strong>bootstrap distribution</strong> of the t-statistic</p></li>
</ul>
</section>
<section id="section-26" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.90em">
<ul>
<li><p>We now compare the bootstrap t-statistic to the observed statistic <span class="math display">
t_{\rm obs} = \frac{\bar{x} -\bar{y}}{s_p\sqrt{\frac{1}{n}+\frac{1}{m}}} \,, \qquad
s_p = \sqrt{\frac{s^2_X(n-1)+ s^2_Y(m-1)}{n+m-2}}
</span></p></li>
<li><p>A bootstrap simulation of the t-statistic <span class="math inline">t_i^*</span> is <strong>extreme</strong> if</p></li>
</ul>
<table class="caption-top" style="width:55%;">
<colgroup>
<col style="width: 25%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Alternative</strong></th>
<th style="text-align: left;"><span class="math inline">t_i^*</span> <strong>extreme</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\mu_X \neq \mu_Y</span></td>
<td style="text-align: left;"><span class="math inline">|t_i^*| &gt; |t_{\rm obs}|</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\mu_X &lt; \mu_Y</span></td>
<td style="text-align: left;"><span class="math inline">t_i^* &lt; t_{\rm obs}</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\mu_X &gt; \mu_Y</span></td>
<td style="text-align: left;"><span class="math inline">t_i^* &gt; t_{\rm obs}</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The bootstrap p-value is computed by <span class="math display">
p = \frac{\# \text{ of extreme bootstrap simulations}}{B}
</span> Note: Condition <span class="math inline">|t_i^*| &gt; |t_{\rm obs}|</span> is equivalent to <span class="math inline">t_i^* &gt; |t_{\rm obs}|\,</span> or <span class="math inline">\, t_i^* &lt; |t_{\rm obs}|</span></li>
</ul>
</div>
</section>
<section id="algorithm-bootstrap-t-test" class="slide level2 smaller">
<h2>Algorithm: Bootstrap t-test</h2>
<div style="font-size: 0.90em">
<p><strong>Setting:</strong> Given the two samples <span class="math inline">x_1,\ldots,x_n</span> and <span class="math inline">y_1, \ldots, y_m</span></p>
<ol type="1">
<li><p>Compute the observed t-statistic <span class="math inline">t_{\rm obs}</span> on the given data</p></li>
<li><p>Combine the two samples into one sample <span class="math inline">\mathcal{S} = \{ x_1, \ldots, x_n, y_1, \ldots, y_m\}</span></p></li>
<li><p>Sample <span class="math inline">\{x_1^*, \ldots, x_n^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</p></li>
<li><p>Sample <span class="math inline">\{y_1^*, \ldots, y_m^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</p></li>
<li><p>Compute the t-statistic on the bootstrap samples</p></li>
<li><p>Repeat steps 3-5, <span class="math inline">B</span> times, obtaining <span class="math inline">B</span> bootstrap simulations of t-statistic <span class="math inline">t^*_1, \ldots , t^*_B</span></p></li>
</ol>
<div class="column" style="width:38%;">
<ol start="7" type="1">
<li>Compute the p-value by <span class="math display">
p = \frac{\# \text{ extreme } t_i^*}{B}
</span></li>
</ol>
</div><div class="column" style="width:48%;">
<table class="caption-top" style="width:80%;">
<colgroup>
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Alternative</strong></th>
<th style="text-align: left;"><span class="math inline">t_i^*</span> <strong>extreme</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\mu_X^2 \neq \mu^2_Y</span></td>
<td style="text-align: left;"><span class="math inline">|t_i^*| &gt; |t_{\rm obs}|</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\mu_X &lt; \mu_Y</span></td>
<td style="text-align: left;"><span class="math inline">t_i^* &lt; t_{\rm obs}</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\mu_X &gt; \mu_Y</span></td>
<td style="text-align: left;"><span class="math inline">t_i^* &gt; t_{\rm obs}</span></td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="worked-example-3" class="slide level2 smaller">
<h2>Worked Example</h2>
<ul>
<li>Compensation data for a sample of CEOs in 2012 and 2013<br>
(USA data, in million dollars)</li>
</ul>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CEO Pay 2013</strong></td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">20.4</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>CEO Pay 2012</strong></td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">3.2</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li>We want to test for a difference in means</li>
</ul>
<p><span class="math display">
H_0 \colon \mu_X = \mu_Y \,, \qquad H_1 \colon \mu_X \neq \mu_Y
</span></p>
<p><strong>Does average pay change from 2012 to 2013?</strong></p>
</section>
<section id="plotting-the-densities" class="slide level2 smaller">
<h2>Plotting the densities</h2>
<ul>
<li>We see that Pay is not normally distributed <span class="math inline">\implies</span> Bootstrap t-test is appropriate</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>View the R Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter the Wages data</span></span>
<span id="cb41-2"><a aria-hidden="true" tabindex="-1"></a>ceo13 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">3.8</span>, <span class="fl">2.6</span>, <span class="fl">3.5</span>, <span class="fl">7.0</span>, <span class="fl">20.4</span>, <span class="fl">7.5</span>, <span class="fl">3.4</span>, <span class="fl">5.0</span>, <span class="fl">6.0</span>)</span>
<span id="cb41-3"><a aria-hidden="true" tabindex="-1"></a>ceo12 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">23.5</span>, <span class="fl">6.4</span>, <span class="fl">11.1</span>, <span class="fl">3.8</span>, <span class="fl">8.9</span>, <span class="fl">4.8</span>, <span class="fl">23.8</span>, <span class="fl">3.0</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb41-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the estimated distributions</span></span>
<span id="cb41-7"><a aria-hidden="true" tabindex="-1"></a>d.ceo13 <span class="ot">&lt;-</span> <span class="fu">density</span>(ceo13)</span>
<span id="cb41-8"><a aria-hidden="true" tabindex="-1"></a>d.ceo12 <span class="ot">&lt;-</span> <span class="fu">density</span>(ceo12)</span>
<span id="cb41-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the estimated distributions</span></span>
<span id="cb41-12"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(d.ceo13,                                    <span class="co"># Plot d.ceo13</span></span>
<span id="cb41-14"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">range</span>(<span class="fu">c</span>(d.ceo12<span class="sc">$</span>x, d.ceo13<span class="sc">$</span>x)),        <span class="co"># Set x-axis range</span></span>
<span id="cb41-15"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(d.ceo12<span class="sc">$</span>y, d.ceo13<span class="sc">$</span>y)),        <span class="co"># Set y-axis range</span></span>
<span id="cb41-16"><a aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Estimated Distributions of CEOs Pay"</span>) <span class="co"># Add title to plot</span></span>
<span id="cb41-17"><a aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(d.ceo12,                                    <span class="co"># Layer plot of d.ceo12</span></span>
<span id="cb41-18"><a aria-hidden="true" tabindex="-1"></a>      <span class="at">lty =</span> <span class="dv">2</span>)                                  <span class="co"># Use different line style</span></span>
<span id="cb41-19"><a aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb41-20"><a aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,                               <span class="co"># Add legend at top-right</span></span>
<span id="cb41-21"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"CEOs Pay 2013"</span>,             <span class="co"># Labels for legend</span></span>
<span id="cb41-22"><a aria-hidden="true" tabindex="-1"></a>                  <span class="st">"CEOs Pay 2012"</span>), </span>
<span id="cb41-23"><a aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                           <span class="co"># Assign curves to legend          </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="appendix_C_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="enter-the-data-and-compute-t_rm-obs" class="slide level2 smaller">
<h2>Enter the data and compute <span class="math inline">t_{\rm obs}</span></h2>
<ul>
<li>Enter the data</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a aria-hidden="true" tabindex="-1"></a>ceo13 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">3.8</span>, <span class="fl">2.6</span>, <span class="fl">3.5</span>, <span class="fl">7.0</span>, <span class="fl">20.4</span>, <span class="fl">7.5</span>, <span class="fl">3.4</span>, <span class="fl">5.0</span>, <span class="fl">6.0</span>)</span>
<span id="cb42-2"><a aria-hidden="true" tabindex="-1"></a>ceo12 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">23.5</span>, <span class="fl">6.4</span>, <span class="fl">11.1</span>, <span class="fl">3.8</span>, <span class="fl">8.9</span>, <span class="fl">4.8</span>, <span class="fl">23.8</span>, <span class="fl">3.0</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Calculate <span class="math inline">t_{\rm obs}</span>
<ul>
<li>This can be done by using <code>t.test</code></li>
<li>Under the null hypothesis, the two samples come from the same population</li>
<li>Therefore, we need to specify the populations have the same variance</li>
<li>This is done by including <code>var.equal = T</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate observed t-statistic</span></span>
<span id="cb43-2"><a aria-hidden="true" tabindex="-1"></a>t.obs <span class="ot">&lt;-</span> <span class="fu">t.test</span>(ceo13, ceo12, <span class="at">var.equal =</span> T)<span class="sc">$</span>statistic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>         t 
-0.9491981 </code></pre>
</div>
</div>
</section>
<section id="simulating-a-single-bootstrap-t-statistic" class="slide level2 smaller">
<h2>Simulating a single bootstrap t-statistic</h2>
<ul>
<li>Compute sample size, and combine the observations into a single sample</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sample size</span></span>
<span id="cb45-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ceo13)</span>
<span id="cb45-3"><a aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(ceo12)</span>
<span id="cb45-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the samples</span></span>
<span id="cb45-6"><a aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> <span class="fu">c</span>(ceo13, ceo12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Calculate one bootstrap sample from mathematicians and accountants</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a aria-hidden="true" tabindex="-1"></a>ceo13.boot <span class="ot">&lt;-</span><span class="fu">sample</span>(combined, n, <span class="at">replace =</span> T)</span>
<span id="cb46-2"><a aria-hidden="true" tabindex="-1"></a>ceo12.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined, m, <span class="at">replace =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Calculate the simulated bootstrap <span class="math inline">t</span>-statistic</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a aria-hidden="true" tabindex="-1"></a>t.boot <span class="ot">&lt;-</span> <span class="fu">t.test</span>(ceo13.boot, ceo12.boot, <span class="at">var.equal =</span> T)<span class="sc">$</span>statistic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          t 
-0.02904949 </code></pre>
</div>
</div>
</section>
<section id="bootstrapping-the-t-static" class="slide level2 smaller">
<h2>Bootstrapping the t-static</h2>
<div style="font-size: 0.92em">
<ul>
<li><p>In the previous slide we generated one simulated value of the t-statistic</p></li>
<li><p>To generate <span class="math inline">B = 10,000</span> bootstrap simulations, we use <code>replicate</code></p></li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap the t-statistic B = 10,000 times</span></span>
<span id="cb49-2"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb49-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a aria-hidden="true" tabindex="-1"></a>t.boot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb49-5"><a aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Single bootstrap sample</span></span>
<span id="cb49-6"><a aria-hidden="true" tabindex="-1"></a>                    ceo13.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined, n, <span class="at">replace =</span> T)</span>
<span id="cb49-7"><a aria-hidden="true" tabindex="-1"></a>                    ceo12.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined, m, <span class="at">replace =</span> T)</span>
<span id="cb49-8"><a aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb49-9"><a aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Return single bootstrap t-statistic</span></span>
<span id="cb49-10"><a aria-hidden="true" tabindex="-1"></a>                    <span class="fu">t.test</span>(ceo13.boot, ceo12.boot, <span class="at">var.equal =</span> T)<span class="sc">$</span>statistic</span>
<span id="cb49-11"><a aria-hidden="true" tabindex="-1"></a>                    })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The vector <code>t.boot</code> contains <span class="math inline">B=10,000</span> bootstrap simulations of the t-statistic</li>
</ul>
</div>
</section>
<section id="compute-the-bootstrap-p-value" class="slide level2 smaller">
<h2>Compute the bootstrap p-value</h2>
<div style="font-size: 0.92em">
<ul>
<li>We are conducting a two-sided test. Hence, the bootstrap p-value is <span class="math display">
p = \frac{ \# \text{ extreme } t^*_i}{B} =
  \frac{ \#_{i=1}^B \, |t^*_i| &gt; |t_{\rm obs}| }{B}
</span></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of extreme statistics for two-sided test</span></span>
<span id="cb50-2"><a aria-hidden="true" tabindex="-1"></a>extreme <span class="ot">&lt;-</span> <span class="fu">sum</span> ( <span class="fu">abs</span>( t.boot ) <span class="sc">&gt;</span> <span class="fu">abs</span> (t.obs) )</span>
<span id="cb50-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value</span></span>
<span id="cb50-5"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> extreme <span class="sc">/</span> B</span>
<span id="cb50-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb50-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The bootstrap p-value is:"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The bootstrap p-value is: 0.3715</code></pre>
</div>
</div>
<ul>
<li><p><strong>Conclusion:</strong> No evidence (<span class="math inline">p &gt; 0.05</span>) of a difference in pay between 2012 and 2013</p></li>
<li><p>The code can be downloaded here <a href="codes/bootstrap_t_test.R">bootstrap_t_test.R</a></p></li>
</ul>
</div>
</section>
<section id="comparison-with-normal-family-test" class="slide level2 smaller">
<h2>Comparison with normal family test</h2>
<ul>
<li><p>The bootstrap p-value just computed is <span class="math inline">p = 0.3715</span></p></li>
<li><p>We compare it to the two-sample t-test p-value</p></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(ceo13, ceo12, <span class="at">var.equal =</span> T)<span class="sc">$</span>p.value</span>
<span id="cb52-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The t-test p-value is:"</span>, p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The t-test p-value is: 0.3550911</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li><p>The two p-values are quite similar, even though the data is non-normal</p></li>
<li><p>This indicates that the t-test is fairly robust to non-normality</p></li>
</ul>
<p><strong>However, since data is non-normal, the bootstrap t-test is the preferred choice</strong></p>
</section></section>
<section>
<section id="part-6-bootstrap-f-test" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 6: <br> Bootstrap F-test</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="bootstrap-f-test-procedure" class="slide level2 smaller">
<h2>Bootstrap F-test procedure</h2>
<ul>
<li>Suppose given a cdf <span class="math inline">G(\cdot)</span>, and two samples:
<ul>
<li><span class="math inline">x_1, \ldots, x_n</span> from a population <span class="math inline">X</span> with cdf <span class="math inline">\, G \left( x - \mu_X \right)</span></li>
<li><span class="math inline">y_1, \ldots, y_m</span> from a population <span class="math inline">Y</span> with cdf <span class="math inline">\, G \left( \dfrac{y - \mu_Y }{\Delta} \right)</span></li>
</ul></li>
<li><strong>Note:</strong> Population distributions have similar shape,
<ul>
<li>However means and spreads are (potentially) different</li>
</ul></li>
<li>Denoting by <span class="math inline">\sigma^2_X</span> and <span class="math inline">\sigma^2_Y</span> the variances of <span class="math inline">X</span> and <span class="math inline">Y</span>, we have <span class="math display">
\Delta = \frac{\sigma^2_X}{\sigma^2_Y}
</span></li>
</ul>
</section>
<section id="section-27" class="slide level2 smaller">
<h2></h2>
<ul>
<li>We want to test for <strong>difference in variances</strong></li>
</ul>
<p><span class="math display">
H_0 \colon \sigma^2_X = \sigma^2_Y \,, \quad \qquad
H_1 \colon \sigma^2_X \neq \sigma^2_Y  \,, \quad \text{ or } \quad \sigma^2_X &gt; \sigma^2_Y
</span></p>
<ul>
<li><p><strong>As usual for F-test, we label the samples so that <span class="math inline">s_X^2 \geq s_Y^2</span></strong></p></li>
<li><p>Not making assumptions on population <span class="math inline">G \implies</span> distribution of F-statistic is unknown</p>
<ul>
<li>Need to bootstrap the F-statistic</li>
</ul></li>
<li><p><strong>Assume the null hypothesis is true:</strong> <span class="math display">
\sigma_X^2 = \mu_Y^2  \quad \implies \quad
\Delta = \frac{\sigma^2_X}{\sigma^2_Y} = 1
</span></p></li>
</ul>
</section>
<section id="section-28" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>Hence, under <span class="math inline">H_0</span>, the two samples <span class="math inline">X</span> and <span class="math inline">Y</span> have cdfs <span class="math display">
G \left( x - \mu_X \right) \quad \text{ and } \quad  G \left(y - \mu_Y \right)
</span></p></li>
<li><p>By centering, we obtain that <span class="math display">
X - \mu_X \quad \text{ and } \quad Y - \mu_Y \quad \text{ have both cdf } \quad  G \left( z \right)
</span></p></li>
<li><p>Thus, the two <strong>centered</strong> samples are part of a single sample of size <span class="math inline">n+m</span> <span class="math display">
\mathcal{S} = \{x_1 - \overline{x}, \ldots, x_n - \overline{x} , y_1 - \overline{y}, \ldots, y_m - \overline{y} \}
</span></p></li>
<li><p>The sample distribution <span class="math inline">\hat{G}</span> of <span class="math inline">\mathcal{S}</span> is an approximation of <span class="math inline">G</span><br>
(Glivenko-Cantelli Theorem)</p></li>
<li><p>We bootstrap the F-statistic from the centered combined sample <span class="math inline">\mathcal{S}</span></p></li>
</ul>
</section>
<section id="section-29" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The bootstrap samples are generated as follows:</p>
<ul>
<li>Sample <span class="math inline">\{x_1^*, \ldots, x_n^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</li>
<li>Sample <span class="math inline">\{y_1^*, \ldots, y_m^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</li>
</ul></li>
<li><p>Compute a bootstrap simulation of the F-statistic <span class="math display">
F^* =  \frac{(s_X^2)^*}{(s_Y^2)^*}
</span></p></li>
<li><p>Repeat <span class="math inline">B</span> times to obtain <span class="math display">
F^*_1, \ldots , F^*_B
</span></p></li>
<li><p>These values represent the <strong>bootstrap distribution</strong> of the F-statistic</p></li>
</ul>
</section>
<section id="section-30" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>We now compare the bootstrap F-statistic to the observed statistic <span class="math display">
F_{\rm obs} = \frac{s^2_X}{s^2_Y}
</span></p></li>
<li><p>A bootstrap simulation of the F-statistic <span class="math inline">F_i^*</span> is <strong>extreme</strong> if</p></li>
</ul>
<table class="caption-top" style="width:65%;">
<colgroup>
<col style="width: 25%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Alternative</strong></th>
<th style="text-align: left;"><span class="math inline">F_i^*</span> <strong>extreme</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\sigma_X^2 \neq \sigma^2_Y</span></td>
<td style="text-align: left;"><span class="math inline">F_i^* &gt; F_{\rm obs} \,</span> or <span class="math inline">F_i^* &lt; 1/F_{\rm obs}</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\sigma_X^2 &gt; \sigma^2_Y</span></td>
<td style="text-align: left;"><span class="math inline">F_i^* &gt; F_{\rm obs}</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The bootstrap p-value is computed by</li>
</ul>
<p><span class="math display">
p = \frac{\# \text{ of extreme bootstrap simulations}}{B}
</span></p>
</section>
<section id="algorithm-bootstrap-f-test" class="slide level2 smaller">
<h2>Algorithm: Bootstrap F-test</h2>
<div style="font-size: 0.90em">
<p><strong>Setting:</strong> Given the two samples <span class="math inline">x_1,\ldots,x_n</span> and <span class="math inline">y_1, \ldots, y_m</span></p>
<ol start="0" type="1">
<li><p>Compute sample variances <span class="math inline">s_X^2</span> and <span class="math inline">s_Y^2</span>. If <span class="math inline">s_Y^2 &gt; s_X^2</span>, swap the samples</p></li>
<li><p>Compute the observed F-statistic <span class="math inline">F_{\rm obs}</span> on the given data</p></li>
<li><p>Combine (centered) samples into <span class="math inline">\mathcal{S} = \{ x_1 - \overline{x}, \ldots, x_n - \overline{x}, y_1 - \overline{y}, \ldots, y_m- \overline{y}\}</span></p></li>
<li><p>Sample <span class="math inline">\{x_1^*, \ldots, x_n^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</p></li>
<li><p>Sample <span class="math inline">\{y_1^*, \ldots, y_m^*\}</span> from <span class="math inline">\mathcal{S}</span> with replacement</p></li>
<li><p>Compute the F-statistic on the bootstrap samples</p></li>
<li><p>Repeat steps 3-5, <span class="math inline">B</span> times, obtaining <span class="math inline">B</span> bootstrap simulations of F-statistic <span class="math inline">F^*_1, \ldots , F^*_B</span></p></li>
</ol>
<div class="column" style="width:38%;">
<ol start="7" type="1">
<li>Compute the p-value by <span class="math display">
p = \frac{\# \text{ extreme } F_i^*}{B}
</span></li>
</ol>
</div><div class="column" style="width:48%;">
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Alternative</strong></th>
<th style="text-align: left;"><span class="math inline">F_i^*</span> <strong>extreme</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\sigma_X^2 \neq \sigma^2_Y</span></td>
<td style="text-align: left;"><span class="math inline">F_i^*&gt; F_{\rm obs} \,</span> of <span class="math inline">\, F_i^* &lt; 1/F_{\rm obs}</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\sigma_X^2 &gt; \sigma^2_Y</span></td>
<td style="text-align: left;"><span class="math inline">F_i^* &gt; F_{\rm obs}</span></td>
</tr>
</tbody>
</table>
</div></div>
</section>
<section id="worked-example-4" class="slide level2 smaller">
<h2>Worked Example</h2>
<ul>
<li>Compensation data for a sample of CEOs in 2012 and 2013<br>
(USA data, in million dollars)</li>
</ul>
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CEO Pay 2013</strong></td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">20.4</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>CEO Pay 2012</strong></td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">11.1</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">3.0</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">3.2</td>
</tr>
</tbody>
</table>
<p><br></p>
<ul>
<li><p>We want to test for a difference in variances <span class="math display">
H_0 \colon \sigma^2_X = \sigma^2_Y \,, \qquad H_1 \colon \sigma^2_X \neq \sigma^2_Y
</span></p></li>
<li><p>We already know that data is non-normal <span class="math inline">\implies</span> Bootstrap F-test is appropriate</p></li>
</ul>
</section>
<section id="enter-the-data" class="slide level2 smaller">
<h2>Enter the data</h2>
<ul>
<li>Enter the data, and compute sample variances</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter the data</span></span>
<span id="cb54-2"><a aria-hidden="true" tabindex="-1"></a>ceo13 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">3.8</span>, <span class="fl">2.6</span>, <span class="fl">3.5</span>, <span class="fl">7.0</span>, <span class="fl">20.4</span>, <span class="fl">7.5</span>, <span class="fl">3.4</span>, <span class="fl">5.0</span>, <span class="fl">6.0</span>)</span>
<span id="cb54-3"><a aria-hidden="true" tabindex="-1"></a>ceo12 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">23.5</span>, <span class="fl">6.4</span>, <span class="fl">11.1</span>, <span class="fl">3.8</span>, <span class="fl">8.9</span>, <span class="fl">4.8</span>, <span class="fl">23.8</span>, <span class="fl">3.0</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>)</span>
<span id="cb54-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compare variances</span></span>
<span id="cb54-6"><a aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">var</span>(ceo12) <span class="sc">&gt;</span> <span class="fu">var</span>(ceo13)) <span class="fu">cat</span>(<span class="st">"Swap the samples!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Swap the samples!</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>We need to swap the labels:
<ul>
<li><span class="math inline">X = \,</span> CEO Pay in 2012 <span class="math inline">\qquad \quad</span> <span class="math inline">Y = \,</span> CEO Pay in 2013</li>
</ul></li>
</ul>
</section>
<section id="compute-f_rm-obs" class="slide level2 smaller">
<h2>Compute <span class="math inline">F_{\rm obs}</span></h2>
<ul>
<li>Calculate <span class="math inline">F_{\rm obs}</span></li>
</ul>
<p><span class="math display">
F_{\rm obs} = \frac{s_X^2}{s_Y^2} = \frac{\rm Variance \,\,\, CEO \, Pay \, in  \, 2012}{\rm Variance \,\,\, CEO \, Pay \, in \, 2013}
</span></p>
<ul>
<li>Note that the samples are swapped (to ensure <span class="math inline">s_X^2 \geq s_Y^2</span>)</li>
</ul>
<p><br></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate observed F-statistic (samples are swapped)</span></span>
<span id="cb56-2"><a aria-hidden="true" tabindex="-1"></a>F.obs <span class="ot">&lt;-</span> <span class="fu">var</span>(ceo12) <span class="sc">/</span> <span class="fu">var</span>(ceo13)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.383577</code></pre>
</div>
</div>
</section>
<section id="simulating-a-single-bootstrap-f-statistic" class="slide level2 smaller">
<h2>Simulating a single bootstrap F-statistic</h2>
<ul>
<li>Compute sample size; combine (centered) observations into a single sample</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sample size (samples are swapped)</span></span>
<span id="cb58-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(ceo12)</span>
<span id="cb58-3"><a aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(ceo13)</span>
<span id="cb58-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the centered samples</span></span>
<span id="cb58-6"><a aria-hidden="true" tabindex="-1"></a>combined.centered <span class="ot">&lt;-</span> <span class="fu">c</span>(ceo12 <span class="sc">-</span> <span class="fu">mean</span>(ceo12), ceo13 <span class="sc">-</span> <span class="fu">mean</span>(ceo13))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Calculate one bootstrap sample from accountants and mathematicians</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a aria-hidden="true" tabindex="-1"></a>ceo12.boot <span class="ot">&lt;-</span><span class="fu">sample</span>(combined.centered, n, <span class="at">replace =</span> T)</span>
<span id="cb59-2"><a aria-hidden="true" tabindex="-1"></a>ceo13.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined.centered, m, <span class="at">replace =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Calculate the simulated bootstrap <span class="math inline">F</span>-statistic</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a aria-hidden="true" tabindex="-1"></a>F.boot <span class="ot">&lt;-</span> <span class="fu">var</span>(ceo12.boot) <span class="sc">/</span> <span class="fu">var</span>(ceo13.boot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.589727</code></pre>
</div>
</div>
</section>
<section id="bootstrapping-the-f-static" class="slide level2 smaller">
<h2>Bootstrapping the F-static</h2>
<div style="font-size: 0.92em">
<ul>
<li><p>In the previous slide we generated one simulated value of the F-statistic</p></li>
<li><p>To generate <span class="math inline">B = 10,000</span> bootstrap simulations, we use <code>replicate</code></p></li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap the F-statistic B = 10,000 times</span></span>
<span id="cb62-2"><a aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a aria-hidden="true" tabindex="-1"></a>F.boot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb62-5"><a aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Single bootstrap sample</span></span>
<span id="cb62-6"><a aria-hidden="true" tabindex="-1"></a>                    ceo12.boot <span class="ot">&lt;-</span><span class="fu">sample</span>(combined.centered, n, <span class="at">replace =</span> T)</span>
<span id="cb62-7"><a aria-hidden="true" tabindex="-1"></a>                    ceo13.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined.centered, m, <span class="at">replace =</span> T)</span>
<span id="cb62-8"><a aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb62-9"><a aria-hidden="true" tabindex="-1"></a>                    <span class="co"># Return single bootstrap F-statistic</span></span>
<span id="cb62-10"><a aria-hidden="true" tabindex="-1"></a>                    <span class="fu">var</span>(ceo12.boot) <span class="sc">/</span> <span class="fu">var</span>(ceo13.boot)</span>
<span id="cb62-11"><a aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The vector <code>F.boot</code> contains <span class="math inline">B=10,000</span> bootstrap simulations of the F-statistic</li>
</ul>
</div>
</section>
<section id="compute-the-bootstrap-p-value-1" class="slide level2 smaller">
<h2>Compute the bootstrap p-value</h2>
<div style="font-size: 0.92em">
<ul>
<li>We are conducting a two-sided test. Hence, the bootstrap p-value is <span class="math display">
p = \frac{ \# \text{ extreme } F^*_i}{B} =
  \frac{ \#_{i=1}^B \,\, F^*_i &gt; F_{\rm obs} \,\, \text{ or } \,\, F^*_i &lt; 1/F_{\rm obs}}{B}
</span></li>
</ul>
<div class="sourceCode" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of extreme statistics for two-sided test</span></span>
<span id="cb63-2"><a aria-hidden="true" tabindex="-1"></a>extreme <span class="ot">&lt;-</span> <span class="fu">sum</span> ( (F.boot <span class="sc">&gt;</span> F.obs) <span class="sc">|</span> (F.boot <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span>F.obs) )</span>
<span id="cb63-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the p-value</span></span>
<span id="cb63-5"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> extreme <span class="sc">/</span> B</span>
<span id="cb63-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb63-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The bootstrap p-value is:"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The bootstrap p-value is: 0.3506</code></pre>
</div>
</div>
<ul>
<li><p><strong>Conclusion:</strong> No evidence (<span class="math inline">p &gt; 0.05</span>) of a difference in variance between populations</p></li>
<li><p>The code can be downloaded here <a href="codes/bootstrap_t_test.R">bootstrap_F_test.R</a></p></li>
</ul>
</div>
</section>
<section id="comparison-with-normal-family-test-1" class="slide level2 smaller">
<h2>Comparison with normal family test</h2>
<ul>
<li><p>The bootstrap p-value just computed is <span class="math inline">p = 0.3506</span></p></li>
<li><p>We compare it to the F-test p-value</p></li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">var.test</span>(ceo12, ceo13)<span class="sc">$</span>p.value</span>
<span id="cb65-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The F-test p-value is:"</span>, p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>The F-test p-value is: 0.2117675</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li><p>The two p-values are quite different (although they give same decision)</p></li>
<li><p>This is due to the non-normality of data</p>
<ul>
<li>shows that the F-test is not very robust to non-normality</li>
</ul></li>
</ul>
<p><strong>Since data is non-normal, the bootstrap F-test is the preferred choice</strong></p>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-efron" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">Efron, Bradley, Tibshirani, Robert J., An introduction to the <span>B</span>ootstrap, Chapman &amp; Hall / CRC, 1994.</div>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>