<!DOCTYPE html>
<html lang="en"><head>
<link href="../favicon.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/foldbox/foldbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Dr.&nbsp;Silvio Fanzon">
  <title>Statistical Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
  .TODO {
    --color1: #e7b1b4;
    --color2: #8c3236;
  }
  .Proposition {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Idea {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Notation {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .Proof {
    --color1: #f1f1f2;
    --color2: #c0c0c1;
  }
  .Definition {
    --color1: #c6e6ed;
    --color2: #1995ad;
  }
  .DONE {
    --color1: #cce7b1;
    --color2: #86b754;
  }
  .Axiom {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Problem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Remark {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Question {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Corollary {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Example {
    --color1: #bce5de;
    --color2: #21aa93;
  }
  .Important {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Lemma {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Warning {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Theorem {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  .Conjecture {
    --color1: #f4cce0;
    --color2: #db4d92;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Models</h1>
  <p class="subtitle">Lecture 6</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://www.silviofanzon.com">Dr.&nbsp;Silvio Fanzon</a> 
</div>
<div class="quarto-title-author-email">
<a href="mailto:S.Fanzon@hull.ac.uk">S.Fanzon@hull.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            University of Hull
          </p>
    </div>
</div>

</section>
<section>
<section id="lecture-6-contingency-tables-simulation" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Lecture 6: <br> Contingency tables &amp; <br> Simulation</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="outline-of-lecture-6" class="slide level2">
<h2>Outline of Lecture 6</h2>
<div class="column" style="width:50%;">
<ol type="1">
<li>Goodness-of-fit test for Contingency tables</li>
<li>Worked Example</li>
<li>Chi-squared test of independence</li>
<li>Worked Example</li>
</ol>
</div><div class="column" style="width:50%;">
<ol start="5" type="1">
<li>Monte Carlo simulations</li>
<li>Simulating p-values</li>
<li>The Bootstrap</li>
</ol>
</div></section></section>
<section>
<section id="part-1-goodness-of-fit-test-for-contingency-tables" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 1: <br>Goodness-of-fit test for <br>Contingency tables</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p><strong>Two-way Contigency Tables:</strong> Table in which each observation is classified in 2 ways</p>
<p><strong>Example:</strong></p>
<ul>
<li><p>Relative performance of Man Utd managers</p></li>
<li><p>Two classifications for each game: Result, and Manager in charge</p></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
</section>
<section id="contingency-tables-abstract-definition" class="slide level2 smaller">
<h2>Contingency tables: Abstract definition</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Each observation
<ul>
<li>has attached two categories <span class="math inline">X</span> and <span class="math inline">Y</span></li>
<li>can only belong to one category <span class="math inline">(X,Y) = (i,j)</span></li>
</ul></li>
<li><span class="math inline">O_{ij}</span> is the <strong>count</strong> of observations with <span class="math inline">(X,Y) = (i,j)</span></li>
<li>Table has <span class="math inline">R</span> rows and <span class="math inline">C</span> columns, for total of <span class="math inline">n = RC</span> categories</li>
</ul>
</section>
<section id="contingency-tables-abstract-definition-1" class="slide level2 smaller">
<h2>Contingency tables: Abstract definition</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li><em>plus</em> symbol in subscript denotes sum over that subscript. Example</li>
</ul>
<p><span class="math display">
O_{R+} = \sum_{j=1}^C O_{Rj} \qquad \quad
O_{+2} = \sum_{i=1}^R O_{i2}
</span></p>
</section>
<section id="contingency-tables-abstract-definition-2" class="slide level2 smaller">
<h2>Contingency tables: Abstract definition</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The total count is</li>
</ul>
<p><span class="math display">
m = O_{++} = \sum_{i=1}^R \sum_{j=1}^C O_{ij}
</span></p>
</section>
<section id="contingency-tables-abstract-definition-3" class="slide level2 smaller">
<h2>Contingency tables: Abstract definition</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal counts sum to <span class="math inline">m</span> as well</li>
</ul>
<p><span class="math display">
\sum_{i=1}^R O_{i+} = \sum_{i=1}^R \sum_{j=1}^C O_{ij} = m
</span></p>
</section>
<section id="contingency-tables-abstract-definition-4" class="slide level2 smaller">
<h2>Contingency tables: Abstract definition</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal counts sum to <span class="math inline">m</span> as well</li>
</ul>
<p><span class="math display">
\sum_{j=1}^C O_{+j} = \sum_{j=1}^C \sum_{i=1}^R  O_{ij} = m
</span></p>
</section>
<section id="contingency-tables-probabilities" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Observation in cell <span class="math inline">(i,j)</span> happens with probability</li>
</ul>
<p><span class="math display">
p_{ij} := P(X = i , Y = j)
</span></p>
</section>
<section id="contingency-tables-probabilities-1" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal probabilities that <span class="math inline">X = i</span> or <span class="math inline">Y = j</span> are at the margins of table</li>
</ul>
<p><span class="math display">
P(X = i) = \sum_{j=1}^C P(X = i , Y = j) = \sum_{j=1}^C p_{ij} = p_{i+}
</span></p>
</section>
<section id="contingency-tables-probabilities-2" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The marginal probabilities that <span class="math inline">X = i</span> or <span class="math inline">Y = j</span> are at the margins of table</li>
</ul>
<p><span class="math display">
P(Y = j) = \sum_{i=1}^R P(X = i , Y = j) = \sum_{i=1}^R p_{ij} = p_{+j}
</span></p>
</section>
<section id="contingency-tables-probabilities-3" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Marginal probabilities sum to <span class="math inline">1</span></li>
</ul>
<p><span class="math display">
\sum_{i=1}^R p_{i+} = \sum_{i=1}^R  P(X = i) = \sum_{i=1}^R \sum_{j=1}^C P(X = i , Y = j) = 1
</span></p>
</section>
<section id="contingency-tables-probabilities-4" class="slide level2 smaller">
<h2>Contingency tables: Probabilities</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">p_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">p_{21}</span></td>
<td style="text-align: center;"><span class="math inline">p_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">p_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Marginal probabilities sum to <span class="math inline">1</span></li>
</ul>
<p><span class="math display">
\sum_{j=1}^C p_{+j} = \sum_{j=1}^C  P(X = j) = \sum_{j=1}^R \sum_{j=1}^C P(X = i , Y = j) = 1
</span></p>
</section>
<section id="multinomial-distribution" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<ul>
<li><p>Counts <span class="math inline">O_{ij}</span> and probabilities <span class="math inline">p_{ij}</span> can be assembled into <span class="math inline">R \times C</span> matrices <span class="math display">
O =
\left(
\begin{array}{ccc}
O_{11} &amp; \ldots &amp; O_{1C} \\
\vdots &amp; \ddots &amp; \vdots \\
O_{R1} &amp; \ldots &amp; O_{RC} \\
\end{array}
\right)
\qquad \qquad
p =
\left(
\begin{array}{ccc}
p_{11} &amp; \ldots &amp; p_{1C} \\
\vdots &amp; \ddots &amp; \vdots \\
p_{R1} &amp; \ldots &amp; p_{RC} \\
\end{array}
\right)
</span></p></li>
<li><p>This way the random matrix <span class="math inline">O</span> has multinomial distribution <span class="math display">
O \sim \mathop{\mathrm{Mult}}(m,p)
</span></p></li>
<li><p>The counts <span class="math inline">O_{ij}</span> are therefore binomial <span class="math display">
O_{ij} \sim \mathop{\mathrm{Bin}}(m,p_{ij})
</span></p></li>
</ul>
</section>
<section id="multinomial-distribution-1" class="slide level2 smaller">
<h2>Multinomial distribution</h2>
<ul>
<li><p>We can also consider the marginal random vectors <span class="math display">
(O_{1+}, \ldots, O_{R+}) \qquad \qquad (O_{+1}, \ldots, O_{+C})
</span></p></li>
<li><p>These have also multinomial distribution <span class="math display">
(O_{1+}, \ldots, O_{R+})  \sim \mathop{\mathrm{Mult}}(m, p_{1+}, \ldots, p_{R+})
</span> <span class="math display">
(O_{+1}, \ldots, O_{+C}) \sim \mathop{\mathrm{Mult}}(m, p_{+1}, \ldots, p_{+C})
</span></p></li>
</ul>
</section>
<section id="expected-counts" class="slide level2 smaller">
<h2>Expected counts</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>We have that <span class="math inline">O_{ij} \sim \mathop{\mathrm{Bin}}(m,p_{ij})</span></li>
<li>We model the <strong>expected counts</strong> for category <span class="math inline">(i,j)</span> as <span class="math display">
E_{ij} := {\rm I\kern-.3em E}[O_{ij}] =  m p_{ij}
</span></li>
</ul>
</section>
<section id="marginal-expected-counts" class="slide level2 smaller">
<h2>Marginal expected counts</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">E_{11}</span></td>
<td style="text-align: center;"><span class="math inline">E_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">E_{21}</span></td>
<td style="text-align: center;"><span class="math inline">E_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">E_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">E_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Due to linearity of expectation, it makes sense to define marginal counts <span class="math display">
E_{i+} := \sum_{j=1}^C E_{ij}
\qquad \qquad
E_{+j} := \sum_{i=1}^R  E_{ij}
</span></li>
</ul>
</section>
<section id="marginal-expected-counts-1" class="slide level2 smaller">
<h2>Marginal expected counts</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">E_{11}</span></td>
<td style="text-align: center;"><span class="math inline">E_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">E_{21}</span></td>
<td style="text-align: center;"><span class="math inline">E_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">E_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">E_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">E_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">E_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">E_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">E_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Marginal expected counts sum to <span class="math inline">m</span>. For example: <span class="math display">
\sum_{i=1}^R E_{i+} = \sum_{i=1}^R \sum_{j=1}^C E_{ij} =  m \sum_{i=1}^R \sum_{j=1}^C p_{ij} = m
</span></li>
</ul>
</section>
<section id="the-chi-squared-statistic" class="slide level2 smaller">
<h2>The chi-squared statistic</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">Y = 2</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">O_{12}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = 2</span></td>
<td style="text-align: center;"><span class="math inline">O_{21}</span></td>
<td style="text-align: center;"><span class="math inline">O_{22}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{2C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{2+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">O_{+2}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<div id="Definition*-2.1" class="Definition">
<p></p><details class="Definition fbx-simplebox fbx-default" open=""><summary><strong>Definition</strong></summary><div>The chi-squared statistic associated to the above contingency table is <span class="math display">
\chi^2 := \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} } =
\sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - m p_{ij})^2 }{ m p_{ij} }
</span><p></p>
</div></details>
</div>
</section>
<section id="distribution-of-chi-squared-statistic" class="slide level2 smaller">
<h2>Distribution of chi-squared statistic</h2>
<div id="Theorem*-2.2" class="Theorem">
<details class="Theorem fbx-simplebox fbx-default" open=""><summary><strong>Theorem</strong></summary><div>
<p>Suppose the counts <span class="math inline">O \sim \mathop{\mathrm{Mult}}(m,p)</span>. Then <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - m p_{ij})^2 }{ m p_{ij} } \
\stackrel{ {\rm d} }{ \longrightarrow } \ \chi_{RC - 1 - {\rm fitted} }^2  
</span> when sample size <span class="math inline">m  \to \infty</span>. The convergence is in distribution and</p>
<ul>
<li><span class="math inline">\rm fitted = \,</span> # of parameters used to estimate cell probabilities <span class="math inline">p_{ij}</span></li>
</ul>
</div></details>
</div>
<p><strong>Quality of approximation:</strong> The chi-squared approximation is good if <span class="math display">
E_{ij} = m p_{ij} \geq 5  \quad \text{ for all } \,\, i = 1 , \ldots , R  \, \text{ and }
j = 1, \ldots, C
</span></p>
</section>
<section id="goodness-of-fit-test-for-contingency-tables" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<p><strong>Setting:</strong></p>
<ul>
<li><p>Population consists of items of <span class="math inline">n = R \times C</span> different types</p></li>
<li><p><span class="math inline">p_{ij}</span> is probability that an item selected at random is of type <span class="math inline">(i,j)</span></p></li>
<li><p><span class="math inline">p_{ij}</span> is unknown and needs to be estimated</p></li>
<li><p>As guess for <span class="math inline">p_{ij}</span> we take <span class="math inline">p_{ij}^0</span> such that <span class="math display">
0 \leq p_{ij}^0 \leq 1 \qquad \qquad \sum_{i=1}^R \sum_{j=1}^C p_{ij}^0 = 1
</span></p></li>
</ul>
</section>
<section id="goodness-of-fit-test-for-contingency-tables-1" class="slide level2 smaller">
<h2>Goodness-of-fit test for contingency tables</h2>
<p><strong>Hypothesis Test:</strong> We test for equality of <span class="math inline">p_{ij}</span> to <span class="math inline">p_{ij}^0</span> <span class="math display">\begin{align*}
&amp; H_0 \colon p_{ij} = p_{ij}^0 \qquad \text{ for all } \, i = 1, \ldots, R  \,, \text{ and } \, j = 1 , \ldots, C \\
&amp; H_1 \colon p_{ij} \neq p_{ij}^0 \qquad \text{ for at least one pair } \, (i,j)
\end{align*}</span></p>
<p><strong>Sample</strong>:</p>
<ul>
<li>We draw <span class="math inline">m</span> items from population</li>
<li><span class="math inline">O_{ij}</span> denotes the number of items of type <span class="math inline">i</span> drawn</li>
<li>Therefore <span class="math inline">O = (O_{ij})_{ij}</span> is <span class="math inline">\mathop{\mathrm{Mult}}(m,p)</span> with <span class="math inline">p = (p_{ij})_{ij}</span></li>
</ul>
<p><strong>Data</strong>: Matrix of counts <span class="math inline">o = (o_{ij})_{ij}</span></p>
</section>
<section id="procedure" class="slide level2 smaller">
<h2>Procedure</h2>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Compute total counts and expected counts <span class="math display">
m = \sum_{i=1}^R \sum_{j=1}^C o_{ij} \qquad \quad E_{ij} = m p_{ij}^0
</span></li>
<li>Compute the chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}}
</span></li>
</ul></li>
</ol>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>:
<ul>
<li>Check that <span class="math inline">E_{ij} \geq 5</span> for all <span class="math inline">i, j</span></li>
<li>No parameters fitted. By the Theorem we get <span class="math display">
{\rm degrees \,\, freedom} = RC - 1 \qquad \qquad  \chi^2 \ \approx \ \chi_{RC-1}^2
</span></li>
<li>Find critical value <span class="math inline">\chi^2_{RC - 1} (0.05)</span> in chi-squared <a href="files/Statistics_Tables.pdf">Table 2</a></li>
<li>Alternatively, compute p-value in R</li>
</ul></li>
<li><strong>Interpretation</strong>: Reject <span class="math inline">H_0</span> when either <span class="math display">
p &lt; 0.05 \qquad \text{ or } \qquad \chi^2 \in \,\,\text{Rejection Region}
</span></li>
</ol>
<table class="caption-top" style="width:85%;">
<colgroup>
<col style="width: 32%">
<col style="width: 28%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>Rejection Region</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\exists \, (i,j) \,\,</span> s.t. <span class="math inline">\,\, p_{ij} \neq p_{ij}^0</span></td>
<td><span class="math inline">\chi^2 &gt; \chi^2_{RC-1}(0.05)</span></td>
<td><span class="math inline">P(\chi_{RC-1}^2 &gt; \chi^2)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="goodness-of-fit-test-in-r" class="slide level2 smaller">
<h2>Goodness-of-fit test in R</h2>
<ol type="1">
<li>Store matrix of counts <span class="math inline">O = (o_{ij})_{ij}</span> into a single R vector, proceeding row-by-row
<ul>
<li><code>counts &lt;- c(o_11, o_12, ..., o_RC)</code></li>
</ul></li>
<li>Store matrix of null probabilities <span class="math inline">p^0 = (p_{ij}^0)_{ij}</span> into a single R vector (row-by-row)
<ul>
<li><code>nullp.p &lt;- c(p_11, p_12, ..., p_RC)</code></li>
</ul></li>
<li>Perform a chi-squared goodness-of-fit test on <code>counts</code> with <code>null.p</code></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>R command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\exists \, (i,j) \,\,</span> s.t. <span class="math inline">\,\, p_{ij} \neq p_{ij}^0</span></td>
<td><code>chisq.test(counts, p = null.p)</code></td>
</tr>
</tbody>
</table>
<ol start="4" type="1">
<li>Read output: In particular look for the p-value</li>
</ol>
<p><strong>Monte Carlo p-value:</strong> compute with the option <code>simulate.p.value = T</code></p>
<p><strong>Note:</strong> Command in 3 is exactly the same as goodness-of-fit test for simple counts</p>
</section></section>
<section>
<section id="part-2-worked-example" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 2: <br>Worked Example</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="example-manchester-united-performance" class="slide level2 smaller">
<h2>Example: Manchester United performance</h2>
<p><strong>Background story:</strong></p>
<ul>
<li>From 1992 to 2013 Man Utd won 13 Premier Leagues titles out of 21</li>
<li>This is the best performance (of any team) in the Premier League era</li>
<li>This was under manager Sir Alex Ferguson</li>
<li>Ferguson stepped down in 2014</li>
<li>Since 2014 Man Utd has not won the PL and was managed by 6 different people (excluding interims)</li>
</ul>
<p><strong>Question:</strong> Are the 6 managers to blame for worse Team Performance?</p>
</section>
<section id="the-data" class="slide level2 smaller">
<h2>The data</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Table contains Man Utd games since 2014 season (updated to 2024 season)</p></li>
<li><p>To each Man Utd game in the sample we associate two categories:</p>
<ul>
<li>Manager and Result</li>
</ul></li>
</ul>
</section>
<section id="setting-up-the-test" class="slide level2 smaller">
<h2>Setting up the test</h2>
<ul>
<li><p><strong>Question:</strong> Is the number of Wins, Draws and Losses uniformly distributed?</p>
<ul>
<li>If Yes, this would suggest very poor performance</li>
</ul></li>
<li><p><strong>Hypothesis Test:</strong> To answer the question we perform a goodness-of-fit test on <span class="math display">\begin{align*}
&amp; H_0 \colon p_{ij} = p_{ij}^0 \quad \text { for all pairs } \, (i,j)  \\
&amp; H_1 \colon p_{ij} \neq p_{ij}^0 \quad \text { for at least one pair } \, (i,j)  \\
\end{align*}</span></p></li>
<li><p><strong>Null Probabilities:</strong></p>
<ul>
<li>They have to model that Wins, Draws and Losses are uniformly distributed</li>
<li>To compute them, we need to compute total number of games for each manager</li>
</ul></li>
</ul>
</section>
<section id="computing-the-null-probabilities" class="slide level2 smaller">
<h2>Computing the null probabilities</h2>
<ul>
<li>We compute total number of games for each manager</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
<td style="text-align: left;"><span class="math inline">o_{1+} = 51</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
<td style="text-align: left;"><span class="math inline">o_{2+} = 103</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
<td style="text-align: left;"><span class="math inline">o_{3+} = 144</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
<td style="text-align: left;"><span class="math inline">o_{4+} = 168</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
<td style="text-align: left;"><span class="math inline">o_{5+} = 29</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
<td style="text-align: left;"><span class="math inline">o_{6+} = 101</span></td>
</tr>
</tbody>
</table>
<ul>
<li>We also need the total number of games <span class="math display">
m = \sum_{i=1}^R o_{i+} = 596
</span></li>
</ul>
</section>
<section id="computing-the-null-probabilities-1" class="slide level2 smaller">
<h2>Computing the null probabilities</h2>
<div style="font-size: 0.93em">
<ul>
<li><p>The results are <strong>uniformly distributed</strong> if each manager</p>
<ul>
<li>Wins (Draws, Loses) <span class="math inline">1/3</span> of the games he played</li>
</ul></li>
<li><p>Since Manager <span class="math inline">i</span> plays <span class="math inline">o_{i+}</span> games, the expected scores are <span class="math display">
E_{ij} = \frac{o_{i+}}{3} \,, \qquad j=1,2,3
</span></p></li>
<li><p>Recall that the expected scores are modelled as <span class="math display">
E_{ij} = m p_{ij}^0
</span></p></li>
<li><p>Thus, the null probabilities under the assumption of uniform distribution are</p></li>
</ul>
<p><span class="math display">
p_{ij}^0 = \frac13 \times \frac{o_{i+}}{m} \quad \left( = \frac{1}{3} \times \text{Proportion of total games played by Manager } \, i \right)
</span></p>
</div>
</section>
<section id="computing-the-null-probabilities-2" class="slide level2 smaller">
<h2>Computing the null probabilities</h2>
<ul>
<li>Substituting the values of <span class="math inline">o_{i+}</span> and <span class="math inline">m</span>, we obtain the null probabilities</li>
</ul>
<p><span class="math display">\begin{align*}
\text{Moyes: } \quad &amp; p_{1j}^0 = \frac13 \times \frac{ o_{1+} }{ m } = 51 \big/ 1788  \\
\text{Van Gaal: }\quad &amp; p_{2j}^0 = \frac13 \times  \frac{ o_{2+} }{ m } = 103 \big/  1788  \\
\text{Mourinho: } \quad&amp; p_{3j}^0 = \frac13 \times  \frac{ o_{3+} }{ m } =  144 \big/  1788  \\
\text{Solskjaer: } \quad&amp; p_{4j}^0 = \frac13 \times \frac{ o_{4+} }{ m } =  168 \big/ 1788 \\
\text{Rangnick: }\quad &amp; p_{5j}^0 = \frac13 \times \frac{ o_{5+} }{ m } =  29 \big/  1788  \\
\text{ten Hag: }\quad &amp; p_{6j}^0 = \frac13 \times \frac{ o_{6+} }{ m } =  101 \big/  1788
\end{align*}</span></p>
</section>
<section id="summary-counts-and-null-probabilities" class="slide level2 smaller">
<h2>Summary: Counts and Null probabilities</h2>
<p><br></p>
<div class="column" style="width:48%;">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:48%;">
<table class="caption-top">
<colgroup>
<col style="width: 32%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{51}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{51}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{51}{1788}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{103}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{103}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{103}{1788}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{144}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{144}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{144}{1788}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{168}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{168}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{168}{1788}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{29}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{29}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{29}{1788}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{101}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{101}{1788}</span></td>
<td style="text-align: center;"><span class="math inline">\frac{101}{1788}</span></td>
</tr>
</tbody>
</table>
</div></section>
<section id="implementation-in-r" class="slide level2 smaller">
<h2>Implementation in R</h2>
<ul>
<li>Start by storing the matrix of counts into a single R vector, row-by-row</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store matrix of counts into single R vector</span></span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">9</span>, <span class="dv">15</span>,</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">54</span>, <span class="dv">25</span>, <span class="dv">24</span>,</span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">84</span>, <span class="dv">32</span>, <span class="dv">28</span>, </span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">91</span>, <span class="dv">37</span>, <span class="dv">40</span>,</span>
<span id="cb1-6"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">8</span>,</span>
<span id="cb1-7"><a aria-hidden="true" tabindex="-1"></a>            <span class="dv">61</span>, <span class="dv">12</span>, <span class="dv">28</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Then we store the matrix of null probabilities into a single R vector, row-by-row</li>
<li>Null probabilities in each row are the same. Hence we can use the command <code>rep</code></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store matrix of null probabilities into single R vector</span></span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a><span class="co"># To avoid copy pasting, first store probabilities of each Manager</span></span>
<span id="cb2-3"><a aria-hidden="true" tabindex="-1"></a>manager.null.p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">51</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">103</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">144</span><span class="sc">/</span><span class="dv">1788</span>, </span>
<span id="cb2-4"><a aria-hidden="true" tabindex="-1"></a>                    <span class="dv">168</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">29</span><span class="sc">/</span><span class="dv">1788</span>, <span class="dv">101</span><span class="sc">/</span><span class="dv">1788</span>)</span>
<span id="cb2-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat each entry 3 times </span></span>
<span id="cb2-7"><a aria-hidden="true" tabindex="-1"></a>null.p <span class="ot">&lt;-</span> <span class="fu">rep</span>(manager.null.p, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<ul>
<li>Let us print the (rounded) null probabilities to aid visualization</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(null.p,<span class="dv">2</span>))     <span class="co"># Rounds to 2 d.p.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.03 0.03 0.03 0.06 0.06 0.06 0.08 0.08 0.08 0.09 0.09 0.09 0.02 0.02 0.02
[16] 0.06 0.06 0.06</code></pre>
</div>
</div>
</section>
<section id="section-3" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Finally we perform the goodness-of-fit test on <code>counts</code> and <code>null.p</code></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform goodness-of-fit test</span></span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null.p)</span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb5-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The code can be downloaded here <a href="codes/good_fit_contingency.R">good_fit_contingency.R</a></li>
</ul>
</section>
<section id="output" class="slide level2 smaller">
<h2>Output</h2>
<ul>
<li>Running the code we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  counts
X-squared = 137.93, df = 17, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>p-value is <span class="math inline">p \approx 0 &lt; 0.05</span></li>
<li>We therefore reject <span class="math inline">H_0</span></li>
<li>Significant evidence that results of Man Utd games are not uniformly distributed</li>
<li>Low goal-scoring rates in soccer mean roughly <span class="math inline">1/3</span> of games end in a draw</li>
<li>Hence Man Utd is not actually doing too bad</li>
</ul>
</section></section>
<section>
<section id="part-3-chi-squared-test-of-independence" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 3: <br>Chi-squared test <br>of independence</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="testing-for-independence" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Consider a two-way contingency table as above</p></li>
<li><p>To each person we associate two categories:</p>
<ul>
<li>Residential Status: Rental or Owned</li>
<li>Region in which they live: NW, London, SW</li>
</ul></li>
</ul>
</section>
<section id="testing-for-independence-1" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li>One possible question is:
<ul>
<li>Does Residential Status depend on Region?</li>
<li>In other words: Are rows and columns dependent?</li>
</ul></li>
</ul>
</section>
<section id="testing-for-independence-2" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Looking at the data, it seems clear that:
<ul>
<li>London: Rentals are almost comparable to Owned</li>
<li>NW and SW: Rentals are almost a third of Owned</li>
<li>It appears Residential Status and Region are dependent features</li>
</ul></li>
<li><strong>Goal:</strong> Formulate test for independence</li>
</ul>
</section>
<section id="testing-for-independence-3" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Consider the general two-way contingency table as above</p></li>
<li><p>They are equivalent:</p>
<ul>
<li>Rows and columns are independent</li>
<li>Random variables <span class="math inline">X</span> and <span class="math inline">Y</span> are independent</li>
</ul></li>
</ul>
</section>
<section id="testing-for-independence-4" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">O_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">O_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">O_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">O_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">O_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">O_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>Hence, testing for independece means testing following hypothesis: <span class="math display">\begin{align*}
&amp; H_0 \colon X \, \text{ and } \, Y \, \text{ are independent } \\
&amp; H_1 \colon X \, \text{ and } \, Y \, \text{ are not independent }
\end{align*}</span></p></li>
<li><p>We need to quantify <span class="math inline">H_0</span> and <span class="math inline">H_1</span></p></li>
</ul>
</section>
<section id="testing-for-independence-5" class="slide level2 smaller">
<h2>Testing for independence</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">p_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">p_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">p_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">p_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">p_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>R.v. <span class="math inline">X</span> and <span class="math inline">Y</span> are independent iff cell probabilities factor into marginals <span class="math display">
p_{ij} = P(X = i , Y = j) =  P(X = i) P (Y = j) = p_{i+}p_{+j}
</span></p></li>
<li><p>Therefore the hypothesis test for independence becomes <span class="math display">\begin{align*}
&amp; H_0 \colon p_{ij} = p_{i+}p_{+j} \quad \text{ for all } \, i = 1, \ldots , R
\, \text{ and } \, j = 1 ,\ldots C \\
&amp; H_1 \colon p_{ij} \neq p_{i+}p_{+j}  \quad \text{ for some } \, (i,j)
\end{align*}</span></p></li>
</ul>
</section>
<section id="expected-counts-1" class="slide level2 smaller">
<h2>Expected counts</h2>
<ul>
<li><p>Assume the null hypothesis is true <span class="math display">
H_0 \colon p_{ij} = p_{i+}p_{+j} \quad \text{ for all } \, i = 1, \ldots , R
\, \text{ and } \, j = 1 ,\ldots C
</span></p></li>
<li><p>Under <span class="math inline">H_0</span>, the expected counts become <span class="math display">
E_{ij} = m p_{ij} = p_{i+}p_{+j}
</span></p></li>
<li><p>We need a way to estimate the marginal probabilities <span class="math inline">p_{i+}</span> and <span class="math inline">p_{+j}</span></p></li>
</ul>
</section>
<section id="estimating-marginal-probabilities" class="slide level2 smaller">
<h2>Estimating marginal probabilities</h2>
<ul>
<li><p><strong>Goal:</strong> Estimate marginal probabilities <span class="math inline">p_{i+}</span> and <span class="math inline">p_{+j}</span></p></li>
<li><p>By definition we have <span class="math display">
p_{i+} = P( X = i )
</span></p></li>
<li><p>Hence <span class="math inline">p_{i+}</span> is probability of and observation to be classified in <span class="math inline">i</span>-th row</p></li>
<li><p>Estimate <span class="math inline">p_{i+}</span> with the proportion of observations classified in <span class="math inline">i</span>-th row <span class="math display">
p_{i+} := \frac{o_{i+}}{m} = \frac{ \text{Number of observations in } \, i\text{-th row} }{ \text{ Total number of observations} }
</span></p></li>
</ul>
</section>
<section id="estimating-marginal-probabilities-1" class="slide level2 smaller">
<h2>Estimating marginal probabilities</h2>
<ul>
<li><p><strong>Goal:</strong> Estimate marginal probabilities <span class="math inline">p_{i+}</span> and <span class="math inline">p_{+j}</span></p></li>
<li><p>Similarly, by definition <span class="math display">
p_{+j} = P( Y = j )
</span></p></li>
<li><p>Hence <span class="math inline">p_{+j}</span> is probability of and observation to be classified in <span class="math inline">j</span>-th column</p></li>
<li><p>Estimate <span class="math inline">p_{+j}</span> with the proportion of observations classified in <span class="math inline">j</span>-th column <span class="math display">
p_{+j} := \frac{o_{+j}}{m} = \frac{ \text{Number of observations in } \, j\text{-th column} }{ \text{ Total number of observations} }
</span></p></li>
</ul>
</section>
<section id="chi2-statistic-for-testing-independence" class="slide level2 smaller">
<h2><span class="math inline">\chi^2</span> statistic for testing independence</h2>
<ul>
<li><p>Summary: The marginal probabilities are estimated with <span class="math display">
p_{i+} := \frac{o_{i+}}{m}
\qquad \qquad p_{+j} := \frac{o_{+j}}{m}
</span></p></li>
<li><p>Therefore the expected counts become <span class="math display">
E_{ij} = m p_{ij} = m p_{i+} p_{+j} = m \left( \frac{o_{i+}}{m}  \right) \left( \frac{o_{+j}}{m}  \right) = \frac{o_{i+} \, o_{+j}}{m}
</span></p></li>
<li><p>By the Theorem in Slide 20, the chi-squared statistics satisfies <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} } \ \approx \
\chi^2_{RC - 1 - {\rm fitted}}
</span></p></li>
<li><p>We need to compute the number of <strong>fitted parameters</strong></p></li>
</ul>
</section>
<section id="section-4" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>We estimate the first <span class="math inline">R-1</span> row marginals by <span class="math display">
p_{i+} := \frac{o_{i+}}{m} \,, \qquad i = 1 , \ldots, R - 1
</span></p></li>
<li><p>Since the marginals <span class="math inline">p_{i+}</span> sum to <span class="math inline">1</span>, we can obtain <span class="math inline">p_{R+}</span> by <span class="math display">
p_{R+} = 1 - p_{1+} - \ldots - p_{(R-1)+}
     = 1 - \frac{o_{1+}}{m} - \ldots - \frac{o_{(R-1)+}}{m}
</span></p></li>
<li><p>Similarly, we estimate the first <span class="math inline">C-1</span> column marginals by <span class="math display">
p_{+j} = \frac{o_{+j}}{m} \,, \qquad j = 1, \ldots, C - 1
</span></p></li>
<li><p>Since the marginals <span class="math inline">p_{+j}</span> sum to <span class="math inline">1</span>, we can obtain <span class="math inline">p_{+C}</span> by <span class="math display">
p_{+C} = 1 - p_{+1} - \ldots - p_{+(C-1)}
     = 1 - \frac{o_{+1}}{m} - \ldots - \frac{o_{+(C-1)}}{m}
</span></p></li>
</ul>
</section>
<section id="section-5" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>In total, we only have to estimate <span class="math display">
(R - 1) + (C - 1 ) = R + C - 2
</span> parameters</p></li>
<li><p>Therefore, the fitted parameters are <span class="math display">
{\rm fitted} = R + C - 2
</span></p></li>
<li><p>Consequently, the degrees of freedom are <span class="math display">\begin{align*}
RC - 1 - {\rm fitted} &amp; = RC - 1 - R - C + 2  \\
                    &amp; = RC - R - C + 1 \\
                    &amp; = (R - 1)(C - 1)
\end{align*}</span></p></li>
</ul>
</section>
<section id="chi2-statistic-for-testing-independence-1" class="slide level2 smaller">
<h2><span class="math inline">\chi^2</span> statistic for testing independence</h2>
<h3 id="conclusion">Conclusion</h3>
<ul>
<li><p>Assume the null hypothesis of row and column independence <span class="math display">
H_0 \colon p_{ij} = p_{i+}p_{+j} \quad \text{ for all } \, i = 1, \ldots , R
\, \text{ and } \, j = 1 ,\ldots C
</span></p></li>
<li><p>Suppose the counts are <span class="math inline">O \sim \mathop{\mathrm{Mult}}(m,p)</span>, and expected counts are <span class="math display">
E_{ij} = \frac{o_{i+} \, o_{+j}}{m}
</span></p></li>
<li><p>By the previous slides, and Theorem in Slide 20 we have that <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} }
\approx \ \chi_{RC - 1 - {\rm fitted} }^2 = \chi_{(R-1)(C-1)}^2  
</span></p></li>
</ul>
</section>
<section id="chi2-statistic-for-testing-independence-2" class="slide level2 smaller">
<h2><span class="math inline">\chi^2</span> statistic for testing independence</h2>
<h3 id="quality-of-approximation">Quality of approximation</h3>
<p>The chi-squared approximation <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C  \frac{ (O_{ij} - E_{ij})^2 }{ E_{ij} }
\approx \  \chi_{(R-1)(C-1)}^2  
</span> is good if <span class="math display">
E_{ij} \geq 5  \quad \text{ for all } \,\, i = 1 , \ldots , R  \, \text{ and }
j = 1, \ldots, C
</span></p>
</section>
<section id="the-chi-squared-test-of-independence" class="slide level2 smaller">
<h2>The chi-squared test of independence</h2>
<p><strong>Sample:</strong></p>
<ul>
<li><p>We draw <span class="math inline">m</span> individuals from population</p></li>
<li><p>Each individual can be of type <span class="math inline">(i,j)</span>, where</p>
<ul>
<li><span class="math inline">i = 1 , \ldots ,R</span></li>
<li><span class="math inline">j = 1 , \ldots ,C</span></li>
<li>Total of <span class="math inline">n = RC</span> types</li>
</ul></li>
<li><p><span class="math inline">O_{ij}</span> denotes the number of items of type <span class="math inline">(i,j)</span> drawn</p></li>
<li><p><span class="math inline">p_{ij}</span> is probability of observing type <span class="math inline">(i,j)</span></p></li>
<li><p><span class="math inline">p = (p_{ij})_{ij}</span> is probability matrix</p></li>
<li><p>The matrix of counts <span class="math inline">O = (o_{ij})_{ij}</span> has multinomial distribution <span class="math inline">\mathop{\mathrm{Mult}}(m,p)</span></p></li>
</ul>
</section>
<section id="section-6" class="slide level2 smaller">
<h2></h2>
<p><strong>Data:</strong> Matrix of counts, represented by two-way contigency table</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">Y = 1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">Y = C</span></th>
<th style="text-align: center;">Totals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = 1</span></td>
<td style="text-align: center;"><span class="math inline">o_{11}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_{1C}</span></td>
<td style="text-align: center;"><span class="math inline">o_{1+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
<td style="text-align: center;"><span class="math inline">\cdots</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">X = R</span></td>
<td style="text-align: center;"><span class="math inline">o_{R1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_{RC}</span></td>
<td style="text-align: center;"><span class="math inline">o_{R+}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Totals</strong></td>
<td style="text-align: center;"><span class="math inline">o_{+1}</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_{+C}</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
</tbody>
</table>
<p><strong>Hypothesis test:</strong> We test for independence of rows and columns <span class="math display">\begin{align*}
&amp; H_0 \colon X \, \text{ and } \, Y \, \text{ are independent } \\
&amp; H_1 \colon X \, \text{ and } \, Y \, \text{ are not independent }
\end{align*}</span></p>
</section>
<section id="procedure-3-steps" class="slide level2 smaller">
<h2>Procedure: 3 Steps</h2>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li><p>Compute marginal and total counts <span class="math display">
o_{i+} := \sum_{j=1}^C o_{ij} \,, \qquad
o_{+j} := \sum_{i=1}^R o_{ij} \,, \qquad
m = \sum_{i=1}^R o_{i+} =  \sum_{j=1}^C o_{+j}
</span></p></li>
<li><p>Compute the expected counts <span class="math display">
E_{ij} = \frac{o_{i+} \, o_{+j} }{ m }
</span></p></li>
<li><p>Compute the chi-squared statistic <span class="math display">
\chi^2 = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}}
</span></p></li>
</ul></li>
</ol>
</section>
<section id="section-7" class="slide level2 smaller">
<h2></h2>
<ol start="2" type="1">
<li><strong>Statistical Tables or R</strong>:
<ul>
<li>Check that <span class="math inline">E_{ij} \geq 5</span> for all <span class="math inline">i</span> and <span class="math inline">j</span></li>
<li>We fitted <span class="math inline">R + C - 2</span> parameters. By the Theorem we get <span class="math display">
\chi^2 \ \approx \ \chi_{\rm df}^2 \,, \qquad {\rm df} = {\rm degrees \,\, freedom} = (R-1)(C-1)
</span></li>
<li>Find critical value <span class="math inline">\chi^2_{\rm df} (0.05)</span> in chi-squared <a href="files/Statistics_Tables.pdf">Table 2</a></li>
<li>Alternatively, compute p-value in R</li>
</ul></li>
<li><strong>Interpretation</strong>: Reject <span class="math inline">H_0</span> when either <span class="math display">
p &lt; 0.05 \qquad \text{ or } \qquad \chi^2 \in \,\,\text{Rejection Region}
</span></li>
</ol>
<table class="caption-top" style="width:89%;">
<colgroup>
<col style="width: 36%">
<col style="width: 28%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>Rejection Region</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">X</span> and <span class="math inline">Y</span> not independent</td>
<td><span class="math inline">\chi^2 &gt; \chi^2_{\rm{df}}(0.05)</span></td>
<td><span class="math inline">P(\chi_{\rm df}^2 &gt; \chi^2)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="the-chi-squared-test-of-independence-in-r" class="slide level2 smaller">
<h2>The chi-squared test of independence in R</h2>
<ol type="1">
<li>Store each row of counts <span class="math inline">(o_{i1}, o_{i2}, \ldots, o_{iC})</span> in R vector
<ul>
<li><code>row_i &lt;- c(o_i1, o_i2, ..., o_iC)</code></li>
</ul></li>
<li>The matrix of counts <span class="math inline">o = (o_{ij})_{ij}</span> is obtained by assembling rows into a matrix
<ul>
<li><code>counts &lt;- rbind(row_1, ..., row_R)</code></li>
</ul></li>
<li>Perform a chi-squared goodness-of-fit test on <code>counts</code> with <code>null.p</code></li>
</ol>
<table class="caption-top">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th>Alternative</th>
<th>R command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">X</span> and <span class="math inline">Y</span> are independent</td>
<td><code>chisq.test(counts)</code></td>
</tr>
</tbody>
</table>
<ol start="4" type="1">
<li>Read output: In particular look for the p-value</li>
</ol>
<p><strong>Note:</strong> Compute Monte Carlo p-value with option <code>simulate.p.value = TRUE</code></p>
</section></section>
<section>
<section id="part-4-worked-example" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 4: <br> Worked Example</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="example-residential-status-and-region" class="slide level2 smaller">
<h2>Example: Residential Status and Region</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Total</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><span class="math inline">5703</span></td>
<td style="text-align: center;"><span class="math inline">2885</span></td>
<td style="text-align: center;"><span class="math inline">8588</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>People are sampled at random in NW, London and SW</p></li>
<li><p>To each person we associate two categories:</p>
<ul>
<li>Residential Status: Rental or Owned</li>
<li>Region in which they live: NW, London, SW</li>
</ul></li>
<li><p><strong>Question:</strong> Are Residential Status and Region independent?</p></li>
</ul>
</section>
<section id="chi-squared-test-of-independence-by-hand" class="slide level2 smaller">
<h2>Chi-squared test of independence by hand</h2>
<ol type="1">
<li><strong>Calculation</strong>:
<ul>
<li>Total and marginal counts are already provided in the table</li>
</ul></li>
</ol>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Tot</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>NW</strong></td>
<td style="text-align: center;"><span class="math inline">2180</span></td>
<td style="text-align: center;"><span class="math inline">871</span></td>
<td style="text-align: center;"><span class="math inline">o_{1+} = 3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Lon</strong></td>
<td style="text-align: center;"><span class="math inline">1820</span></td>
<td style="text-align: center;"><span class="math inline">1400</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>SW</strong></td>
<td style="text-align: center;"><span class="math inline">1703</span></td>
<td style="text-align: center;"><span class="math inline">614</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Tot</strong></td>
<td style="text-align: center;"><span class="math inline">o_{+1} = 5703</span></td>
<td style="text-align: center;"><span class="math inline">o_{+2} = 2885</span></td>
<td style="text-align: center;"><span class="math inline">m = 8588</span></td>
</tr>
</tbody>
</table>
</section>
<section id="section-8" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Compute the estimated expected counts <span class="math inline">E_{ij} = \dfrac{o_{i+} \, o_{+j} }{ m }</span></li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
<th style="text-align: center;"><strong>Tot</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>NW</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{3051{\times}5703}{8588} \approx 2026</span></td>
<td style="text-align: center;"><span class="math inline">\frac{3051{\times}2885}{8588} \approx 1025</span></td>
<td style="text-align: center;"><span class="math inline">o_{1+} = 3051</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Lon</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{3220{\times}5703}{8588} \approx 2138</span></td>
<td style="text-align: center;"><span class="math inline">\frac{3220{\times}2885}{8588} \approx 1082</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 3220</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>SW</strong></td>
<td style="text-align: center;"><span class="math inline">\frac{2317{\times}5703}{8588} \approx 1539</span></td>
<td style="text-align: center;"><span class="math inline">\frac{2317{\times}1885}{8588} \approx 778</span></td>
<td style="text-align: center;"><span class="math inline">o_{2+} = 2317</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Tot</strong></td>
<td style="text-align: center;"><span class="math inline">o_{+1} = 5703</span></td>
<td style="text-align: center;"><span class="math inline">o_{+2} = 2885</span></td>
<td style="text-align: center;"><span class="math inline">m = 8588</span></td>
</tr>
</tbody>
</table>
</section>
<section id="section-9" class="slide level2 smaller">
<h2></h2>
<ul>
<li>Compute the chi-squared statistic <span class="math display">\begin{align*}
  \chi^2 &amp; = \sum_{i=1}^R \sum_{j=1}^C \frac{ (o_{ij} - E_{ij})^2 }{E_{ij}} \\
         &amp; = \frac{(2180-2026.066)^2}{2026.066} + \frac{(871-1024.934)^2}{1024.934} \\
         &amp; \, + \frac{(1820-2138.293)^2}{2138.293}+\frac{(1400-1081.707)^2}{1081.707} \\
         &amp; \, + \frac{(1703-1538.641)^2}{1538.641}+\frac{(614-778.359)^2}{778.359} \\
         &amp; = 11.695+23.119 \\
         &amp; \, + 47.379+93.658 \\
         &amp; \, + 17.557+34.707 \\
         &amp; = 228.12 \qquad (2\ \text{d.p.})
  \end{align*}</span></li>
</ul>
</section>
<section id="section-10" class="slide level2 smaller">
<h2></h2>
<ol start="2" type="1">
<li><strong>Statistical Tables</strong>:
<ul>
<li>Rows are <span class="math inline">R = 3</span> and columns are <span class="math inline">C = 2</span></li>
<li>Degrees of freedom are <span class="math display">
\, {\rm df} = (R - 1)(C - 1) = 2
</span></li>
<li>We clearly have <span class="math inline">E_{ij} \geq 5</span> for all <span class="math inline">i</span> and <span class="math inline">j</span></li>
<li>Therefore, the following approximation holds <span class="math display">
\chi^2 \ \approx \ \chi_{(R - 1)(C - 1)}^2 = \chi_{2}^2
</span></li>
<li>In chi-squared <a href="files/Statistics_Tables.pdf">Table 2</a>, we find critical value <span class="math display">
\chi^2_{2} (0.05) = 5.99
</span></li>
</ul></li>
</ol>
</section>
<section id="section-11" class="slide level2 smaller">
<h2></h2>
<ol start="3" type="1">
<li><strong>Interpretation</strong>:
<ul>
<li>We have that <span class="math display">
\chi^2 = 228.12 &gt; 5.99 = \chi_{2}^2 (0.05)
</span></li>
<li>Therefore we rejct <span class="math inline">H_0</span>, meaning that rows and columns are dependent</li>
</ul></li>
</ol>
<ul>
<li>There is evidence <span class="math inline">(p &lt; 0.05)</span> that Residential Status depends on Region</li>
<li>By rescaling table values, we can compute the table of percentages</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;"><strong>Owned</strong></th>
<th style="text-align: center;"><strong>Rented</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>North West</strong></td>
<td style="text-align: center;"><span class="math inline">71.5\%</span></td>
<td style="text-align: center;"><span class="math inline">28.5\%</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>London</strong></td>
<td style="text-align: center;"><span class="math inline">56.5\%</span></td>
<td style="text-align: center;"><span class="math inline">43.5\%</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>South West</strong></td>
<td style="text-align: center;"><span class="math inline">73.5\%</span></td>
<td style="text-align: center;"><span class="math inline">26.5\%</span></td>
</tr>
</tbody>
</table>
<ul>
<li>The above suggests that in London fewer homes are Owned and more Rented</li>
</ul>
</section>
<section id="chi-squared-test-of-independence-in-r" class="slide level2 smaller">
<h2>Chi-squared test of independence in R</h2>
<ul>
<li>Test can be performed using code <a href="codes/independence_test.R">independence_test.R</a></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store each row into and R vector</span></span>
<span id="cb7-2"><a aria-hidden="true" tabindex="-1"></a>row_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2180</span>, <span class="dv">871</span>)</span>
<span id="cb7-3"><a aria-hidden="true" tabindex="-1"></a>row_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1820</span>, <span class="dv">1400</span>)</span>
<span id="cb7-4"><a aria-hidden="true" tabindex="-1"></a>row_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1703</span>, <span class="dv">614</span>)</span>
<span id="cb7-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the rows into an R matrix</span></span>
<span id="cb7-7"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">rbind</span>(row_1, row_2, row_3)</span>
<span id="cb7-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test of independence</span></span>
<span id="cb7-10"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts)</span>
<span id="cb7-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb7-13"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="output-1" class="slide level2 smaller">
<h2>Output</h2>
<ul>
<li>Running the code, we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  counts
X-squared = 228.11, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>This confirms the chi-squared statistic computed by hand <span class="math inline">\chi^2  = 228.11</span></li>
<li>It also confirms the degrees of freedom <span class="math inline">\, {\rm df} = 2</span></li>
<li>The p-value is <span class="math inline">p \approx 0 &lt; 0.05</span></li>
<li>Therefore <span class="math inline">H_0</span> is rejected, and Residential Status depends on Region</li>
</ul>
</section>
<section id="exercise-manchester-united-performance" class="slide level2 smaller">
<h2>Exercise: Manchester United performance</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: center;">Manager</th>
<th style="text-align: center;">Won</th>
<th style="text-align: center;">Drawn</th>
<th style="text-align: center;">Lost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Moyes</strong></td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Van Gaal</strong></td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Mourinho</strong></td>
<td style="text-align: center;">84</td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">28</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Solskjaer</strong></td>
<td style="text-align: center;">91</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Rangnick</strong></td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>ten Hag</strong></td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">28</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Table contains Man Utd games since 2014 season (updated to 2024)</p></li>
<li><p>To each Man Utd game in the sample we associate two categories:</p>
<ul>
<li>Manager and Result</li>
</ul></li>
<li><p><strong>Question:</strong> Is there association between Manager and Team Performance?</p></li>
</ul>
</section>
<section id="solution" class="slide level2 smaller">
<h2>Solution</h2>
<ul>
<li><p>To answer the question, we perform chi-squared test of independence in R</p></li>
<li><p>Test can be performed by suitably modifying the code <a href="codes/independence_test.R">independence_test.R</a></p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Store each row into and R vector</span></span>
<span id="cb9-2"><a aria-hidden="true" tabindex="-1"></a>row_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">9</span>, <span class="dv">15</span>)</span>
<span id="cb9-3"><a aria-hidden="true" tabindex="-1"></a>row_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">54</span>, <span class="dv">25</span>, <span class="dv">24</span>) </span>
<span id="cb9-4"><a aria-hidden="true" tabindex="-1"></a>row_3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">32</span>, <span class="dv">28</span>) </span>
<span id="cb9-5"><a aria-hidden="true" tabindex="-1"></a>row_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">91</span>, <span class="dv">37</span>, <span class="dv">40</span>)</span>
<span id="cb9-6"><a aria-hidden="true" tabindex="-1"></a>row_5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">10</span>, <span class="dv">8</span>)</span>
<span id="cb9-7"><a aria-hidden="true" tabindex="-1"></a>row_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">12</span>, <span class="dv">28</span>)</span>
<span id="cb9-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Assemble the rows into an R matrix</span></span>
<span id="cb9-10"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">rbind</span>(row_1, row_2, row_3, row_4, row_5, row_6)</span>
<span id="cb9-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test of independence</span></span>
<span id="cb9-13"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts)</span>
<span id="cb9-14"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print answer</span></span>
<span id="cb9-16"><a aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="output-2" class="slide level2 smaller">
<h2>Output</h2>
<ul>
<li>Running the code we obtain</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  counts
X-squared = 12.678, df = 10, p-value = 0.2422</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>p-value is <span class="math inline">p \approx 0.24 &gt; 0.05</span></li>
<li>We do not reject <span class="math inline">H_0</span></li>
<li>There is no evidence of association between Manager and Team Performance</li>
<li>This suggests that changing the manager alone will not resolve poor performance</li>
</ul>
</section></section>
<section>
<section id="part-5-monte-carlo-simulations" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 5: <br>Monte Carlo <br> simulations</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="for-simple-counts-we-said-that" class="slide level2 smaller">
<h2>For simple counts, we said that:</h2>
<ul>
<li><p>The distribution of the <span class="math inline">\chi^2</span> statistic is approximately <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i } \ \approx \ \chi_{n-1}^2  
</span></p></li>
<li><p>The approximation is:</p>
<table class="caption-top">
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Good</strong></th>
<th style="text-align: left;"><span class="math inline">E_i \geq 5  \, \text{ for all } \, i = 1 , \ldots n</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Bad</strong></td>
<td style="text-align: left;"><span class="math inline">E_i &lt; 5 \,</span> for some <span class="math inline">\, i = 1 , \ldots n</span></td>
</tr>
</tbody>
</table></li>
<li><p><strong>How to compute the p-value:</strong> When approximation is</p>
<ul>
<li><strong>Good:</strong> Use <span class="math inline">\chi_{n-1}^2</span> approximation of <span class="math inline">\chi^2</span></li>
<li><strong>Bad:</strong> Use Monte Carlo simulations</li>
</ul></li>
<li><p><strong>Question:</strong> What is a Monte Carlo simulation?</p></li>
</ul>
</section>
<section id="monte-carlo-methods" class="slide level2 smaller">
<h2>Monte Carlo methods</h2>
<ul>
<li><strong>Monte Carlo methods:</strong>
<ul>
<li>Broad class of computational algorithms</li>
<li>They rely on repeated random sampling to obtain numerical results</li>
<li>Principle: use randomness to solve problems which are deterministic</li>
</ul></li>
<li><strong>Why the name?</strong>
<ul>
<li>Method was developed by <a href="https://en.wikipedia.org/wiki/Stanisaw_Ulam">Stanislaw Ulam</a></li>
<li>His uncle liked to gamble in the MonteCarlo Casino in Monaco</li>
</ul></li>
<li><strong>Examples of applications:</strong>
<ul>
<li>First used to solve problem of neutron diffusion in Los Alamos 1946</li>
<li>Can be used to compute integrals</li>
<li><strong>Can be used to compute p-values</strong></li>
</ul></li>
</ul>
</section>
<section id="example-approximation-of-pi" class="slide level2 smaller">
<h2>Example: Approximation of <span class="math inline">\pi</span></h2>
<div class="column" style="width:49%;">
<ul>
<li>Throw random points inside square of side <span class="math inline">2</span></li>
<li>Count proportion of points falling inside unit circle</li>
<li>Such proportion approximates <span class="math inline">\pi</span> (area of the circle)
<ul>
<li><span class="math inline">r = \,</span> Red point</li>
<li><span class="math inline">b = \,</span> Blue point</li>
<li><span class="math inline">n = r + b</span> Total points</li>
</ul></li>
</ul>
<p><span class="math display">
\frac{\pi}{4} \approx \frac{r}{n} \,\, \implies \,\,
\pi \approx \frac{4r}{n}
</span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="images/pi_monte_carlo.gif" style="width:80.0%"></p>
</div></section>
<section id="approximating-pi-formal-model" class="slide level2 smaller">
<h2>Approximating <span class="math inline">\pi</span>  Formal model</h2>
<ul>
<li><p>Draw <span class="math inline">x_1, \ldots, x_N</span> and <span class="math inline">y_1, \ldots, y_N</span> from <span class="math inline">{\rm Uniform(-1,1)}</span></p></li>
<li><p>Count the number of points <span class="math inline">(x_i,y_i)</span> falling inside circle of radius <span class="math inline">1</span></p></li>
<li><p>These are points satisfying condition <span class="math display">
x_i^2 + y_i^2 \leq 1
</span></p></li>
<li><p>Area of circle estimated with proportion of points falling inside circle: <span class="math display">
\text{Area} \ = \ \pi \ \approx \ \frac{\text{Number of points } (x_i,y_i) \text{ inside circle}}{N}  \ \times \ 4
</span></p></li>
<li><p>Note: <span class="math inline">4</span> is the area of square of side <span class="math inline">2</span></p></li>
</ul>
</section>
<section id="section-12" class="slide level2 smaller">
<h2></h2>
<p><strong>Plot: 1000 random points in square of side 2</strong></p>

<img data-src="lecture_6_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="approximation-of-pi-in-r" class="slide level2 smaller">
<h2>Approximation of <span class="math inline">\pi</span> in R</h2>
<div style="font-size: 0.93em">
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>      <span class="co"># We do 100000 iterations and print every 10000</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="dv">0</span>      <span class="co"># Counts total number of points</span></span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a>in_circle <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Counts points falling in circle</span></span>
<span id="cb11-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {   <span class="co"># This loop is for printing message every N iterations</span></span>
<span id="cb11-6"><a aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {  <span class="co"># Loop in which points are counted</span></span>
<span id="cb11-7"><a aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>); y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>);  <span class="co"># sample point (x,y)</span></span>
<span id="cb11-8"><a aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;=</span> <span class="dv">1</span>) {    </span>
<span id="cb11-9"><a aria-hidden="true" tabindex="-1"></a>      in_circle <span class="ot">&lt;-</span> in_circle <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># If (x,y) in circle increase counter</span></span>
<span id="cb11-10"><a aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-11"><a aria-hidden="true" tabindex="-1"></a>    total <span class="ot">&lt;-</span> total <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Increase total counter (in any case)</span></span>
<span id="cb11-12"><a aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-14"><a aria-hidden="true" tabindex="-1"></a>  pi_approx <span class="ot">&lt;-</span> ( in_circle <span class="sc">/</span> total ) <span class="sc">*</span> <span class="dv">4</span>  <span class="co"># Compute approximate area</span></span>
<span id="cb11-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"After %8d iterations pi is %.08f, error is %.08f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb11-17"><a aria-hidden="true" tabindex="-1"></a>     (j <span class="sc">*</span> N), pi_approx, <span class="fu">abs</span>(pi_approx <span class="sc">-</span> pi)))</span>
<span id="cb11-18"><a aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The R code can be downloaded here <a href="codes/monte_carlo_pi.R">monte_carlo_pi.R</a></li>
</ul>
</section>
<section id="approximation-of-pi-in-r-output" class="slide level2 smaller">
<h2>Approximation of <span class="math inline">\pi</span> in R: Output</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>After    10000 iterations pi is 3.15160000, error is 0.01000735
After    20000 iterations pi is 3.13360000, error is 0.00799265
After    30000 iterations pi is 3.13253333, error is 0.00905932
After    40000 iterations pi is 3.13610000, error is 0.00549265
After    50000 iterations pi is 3.13736000, error is 0.00423265
After    60000 iterations pi is 3.13680000, error is 0.00479265
After    70000 iterations pi is 3.14074286, error is 0.00084980
After    80000 iterations pi is 3.14250000, error is 0.00090735
After    90000 iterations pi is 3.14288889, error is 0.00129624
After   100000 iterations pi is 3.14296000, error is 0.00136735</code></pre>
</div>
</div>
<p><strong>Note:</strong></p>
<ul>
<li><p>The error decreases overall, but there are random fluctuations</p></li>
<li><p>This is because we are trying to approximate <span class="math inline">\pi</span> by a random quantity</p></li>
</ul>
</section>
<section id="a-word-on-error-estimates" class="slide level2 smaller">
<h2>A word on error estimates</h2>
<div style="font-size: 0.93em">
<ul>
<li><p>Deriving error estimates for numerical methods is not easy (Numerical Analysis)</p></li>
<li><p>Going back to our example:</p>
<ul>
<li>Let <span class="math inline">n</span> denote the total number of points drawn</li>
<li>Let <span class="math inline">X_n</span> denote the proportion of points falling inside the unit circle</li>
</ul></li>
<li><p>For every <span class="math inline">\varepsilon&gt; 0</span> fixed, it can be shown that <span class="math display">
P( | X_n - \pi/4  | \geq \varepsilon) \leq   {\rm Error} = \frac{1}{20 n \varepsilon^2}
</span></p></li>
<li><p>To get small <em>Error</em>: <span class="math inline">\,\, \varepsilon</span> has to be small, <span class="math inline">n</span> has to be large</p>
<ul>
<li>Fixing a small error threshold <span class="math inline">\varepsilon</span> implies doing more iterations (larger <span class="math inline">n</span>)</li>
<li>Error estimate is probabilistic: Error fluctuates, but decreases with more iterations</li>
</ul></li>
<li><p>Estimate can be derived by interpreting the problem as the Monte Carlo integration of <span class="math inline">\int_0^1 \sqrt{1-x^2} \, dx = \pi /4</span>, see <a href="https://math.stackexchange.com/questions/19119/approximating-pi-using-monte-carlo-integration">stackexchange post</a></p></li>
</ul>
</div>
</section>
<section id="simulation-the-main-point-for-us" class="slide level2 smaller">
<h2>Simulation: The main point (for us)</h2>
<p>Simulation can be used to gain insight into the <strong>shape</strong> of a distribution:</p>
<ul>
<li><p>Mean and variance</p></li>
<li><p>Related probabilities (p-values)</p></li>
</ul>
<p>How to simulate in R:</p>
<ul>
<li>Use loops
<ul>
<li>Example: We used a <code>for</code> loop to simulate <span class="math inline">\pi</span></li>
</ul></li>
<li>Use ad hoc R commands
<ul>
<li><code>replicate(n, expr)</code> repeats expression n times and outputs results</li>
<li><code>apply(x, expr)</code> applies expression to the object <code>x</code></li>
</ul></li>
</ul>
</section>
<section id="example-estimating-mean-variance-of-overlinex" class="slide level2 smaller">
<h2>Example: Estimating mean / variance of <span class="math inline">\overline{X}</span></h2>
<p>Consider sample <span class="math inline">X_1, \ldots, X_n</span> from <span class="math inline">N(\mu,\sigma^2)</span></p>
<ul>
<li><p>Recall that the sample mean satisfies <span class="math display">
{\rm I\kern-.3em E}[\overline{X}] = \mu \,, \qquad {\rm Var}[\overline{X}] = \frac{\sigma^2}{n}
</span> (As <span class="math inline">n</span> gets larger, <span class="math inline">{\rm Var}[\overline{X}]</span> will be closer to <span class="math inline">0</span> <span class="math inline">\implies \overline{X} \approx \mu</span> when <span class="math inline">n</span> is large)</p></li>
<li><p>For example, if the sample size is <span class="math inline">n = 10</span>, mean <span class="math inline">\mu = 0</span> and sd <span class="math inline">\sigma = 1</span>, then <span class="math display">
{\rm I\kern-.3em E}[\overline{X}] = 0 \,, \qquad {\rm Var}[\overline{X}] = \frac{1}{10} = 0.1
</span></p></li>
<li><p>We can obtain the above quantitites through simulation<br>
(In fancy terms: <em>Estimating mean and variance of</em> <span class="math inline">\overline{X}</span>)</p></li>
</ul>
</section>
<section id="section-13" class="slide level2 smaller">
<h2></h2>
<ul>
<li>One simulation of <span class="math inline">\overline{X}</span> can be done as follows:
<ol type="1">
<li>Generate sample <span class="math inline">x_1, \ldots, x_n</span> from <span class="math inline">N(0,1)</span></li>
<li>Compute sample mean of <span class="math inline">x_1, \ldots, x_n</span></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the sample mean xbar</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-4"><a aria-hidden="true" tabindex="-1"></a>sim.xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">rnorm</span>(n)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>To simulate <span class="math inline">M = 1000</span> values from <span class="math inline">\overline{X}</span>, <strong>replicate</strong> the above command <span class="math inline">M</span> times</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate M = 1000 times the sample mean xbar</span></span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>; M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a aria-hidden="true" tabindex="-1"></a>sim.xbar <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">mean</span>(<span class="fu">rnorm</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-14" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The vector <code>sim.xbar</code> contains <span class="math inline">M=1000</span> simulations from <span class="math inline">\overline{X}</span></p></li>
<li><p>Reasonable to suppose that <code>sim.xbar</code> approximates the random variable <span class="math inline">\overline{X}</span><br>
(This can be made rigorous with Central Limit Thm)</p></li>
<li><p>Therefore, we can make the following estimation</p></li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 30%">
<col style="width: 70%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Quantity</th>
<th style="text-align: left;">Estimation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">{\rm I\kern-.3em E}[\overline{X}]</span></td>
<td style="text-align: left;">Sample mean of <code>sim.xbar</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">{\rm Var}[\overline{X}]</span></td>
<td style="text-align: left;">Sample variance of <code>sim.xbar</code></td>
</tr>
</tbody>
</table>
<div style="font-size: 0.51em">
<p><br></p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print mean and variance of sample mean</span></span>
<span id="cb15-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Expected value:"</span>, <span class="fu">mean</span>(sim.xbar), <span class="st">"Variance:"</span>, <span class="fu">var</span>(sim.xbar))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Expected value: 0.005180686   Variance: 0.1058328</code></pre>
</div>
</div>
<div style="font-size: 0.51em">
<p><br></p>
</div>
<p>These are very close to the theoretical values: <span class="math inline">\quad {\rm I\kern-.3em E}[\overline{X}] = 0 \,, \quad {\rm Var}[\overline{X}] = \frac{1}{10} = 0.1</span></p>
</section>
<section id="example-sample-mean-vs-sample-median" class="slide level2 smaller">
<h2>Example: Sample mean VS sample median</h2>
<ul>
<li><p>Both sample mean and median can be used to estimate the center of a distribution</p></li>
<li><p>But which one is better?</p></li>
<li><p>Suppose the population is <span class="math inline">N(\mu,\sigma^2)</span></p></li>
<li><p>We know that the sample mean <span class="math inline">\overline{X}</span> satisfies <span class="math display">
{\rm I\kern-.3em E}[\overline{X}] = \mu \,, \qquad {\rm Var}[\overline{X}] = \frac{\sigma^2}{n}
</span></p></li>
<li><p>However, no such formulas are available for the sample meadian</p></li>
</ul>
<p><strong>Question:</strong> How can we compare them? Use simulation</p>
</section>
<section id="section-15" class="slide level2 smaller">
<h2></h2>
<p>To simulate sample mean and median from <span class="math inline">N(0,1)</span>, we do:</p>
<ul>
<li><p>Generate sample <span class="math inline">x_1, \ldots, x_{10}</span> from <span class="math inline">N(0,1)</span>, and compute sample mean and median</p></li>
<li><p>Repeat <span class="math inline">M = 1000</span> times</p></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span>; n <span class="ot">&lt;-</span> <span class="dv">10</span>  </span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>sim.mean <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">mean</span>(<span class="fu">rnorm</span>(n)))</span>
<span id="cb17-3"><a aria-hidden="true" tabindex="-1"></a>sim.median <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">median</span>(<span class="fu">rnorm</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>To compare simulated sample mean and median, we can produce a boxplot</p></li>
<li><p>The one with smallest variance, will be the better estimator for the true population mean <span class="math inline">\mu = 0</span></p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">list</span>(<span class="st">"sample mean"</span> <span class="ot">=</span> sim.mean, </span>
<span id="cb18-2"><a aria-hidden="true" tabindex="-1"></a>             <span class="st">"sample median"</span> <span class="ot">=</span> sim.median),</span>
<span id="cb18-3"><a aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">"Normal population N(0,1)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-16" class="slide level2 smaller">
<h2></h2>

<img data-src="lecture_6_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"><ul>
<li>The sample mean has less variability</li>
<li>It is the preferred estimator for the true population mean<br>
(when the population is normal)</li>
</ul>
</section>
<section id="example-computing-probabilities" class="slide level2 smaller">
<h2>Example: Computing probabilities</h2>
<p><strong>Question:</strong> What is the probability of rolling <span class="math inline">7</span> with two dice?</p>
<ul>
<li><p>Of course this problem has combinatorial answer: <span class="math inline">p = \frac16</span></p></li>
<li><p>But we can also answer using simulation</p></li>
<li><p>To simulate the roll of a dice, we use the function <code>sample</code></p>
<ul>
<li><code>sample(x, n, replace = T)</code></li>
<li>samples n times from vector <code>x</code> with replacement</li>
</ul></li>
<li><p>To roll 2 dice, we input:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Roll two dice</span></span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>, <span class="at">replace =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1</code></pre>
</div>
</div>
</section>
<section id="section-17" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.94em">
<p>To compute the probability of rolling <span class="math inline">7</span> with two dice we do:</p>
<ul>
<li>Simulate one roll of the two dice, and sum the outcome</li>
<li>Repeat <span class="math inline">M = 1000</span> times</li>
<li>Estimate the probability of rolling a <span class="math inline">7</span> with <span class="math display">
P(\text{Rolling } 7) \approx \frac{\# \text{ of times the simulated roll is } 7 }{1000}
</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a>sim.rolls <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">sum</span>( <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">2</span>, <span class="at">replace =</span> T) ))</span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a>number.of<span class="fl">.7</span>s <span class="ot">&lt;-</span> <span class="fu">sum</span>( sim.rolls <span class="sc">==</span> <span class="dv">7</span> )</span>
<span id="cb21-6"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> number.of<span class="fl">.7</span>s <span class="sc">/</span> M</span>
<span id="cb21-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"The estimated probability of rolling 7 is"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The estimated probability of rolling 7 is 0.166</code></pre>
</div>
</div>
<ul>
<li>This is very close to the theoretical probability <span class="math inline">p = 1/6</span></li>
</ul>
</div>
</section>
<section id="example-interpretation-of-confidence-intervals" class="slide level2 smaller">
<h2>Example: Interpretation of Confidence Intervals</h2>
<ul>
<li><p>Suppose given a normal population <span class="math inline">N(\mu,\sigma^2)</span></p></li>
<li><p>A <span class="math inline">95 \%</span> condence interval for the true mean <span class="math inline">\mu</span> is a (random) interval <span class="math inline">[a,b]</span> s.t. <span class="math display">
P(\mu \in [a,b]) = 0.95
</span></p></li>
<li><p>Confidence interval is <strong>not</strong> probability statement about <span class="math inline">\mu</span>  note <span class="math inline">\mu</span> is a constant!</p></li>
<li><p>It is probability statement about <span class="math inline">[a,b]</span></p></li>
</ul>
<p><strong>Interpretation:</strong> The random interval <span class="math inline">[a,b]</span> contains the mean <span class="math inline">\mu</span> with probability <span class="math inline">0.95</span></p>
</section>
<section id="section-18" class="slide level2 smaller">
<h2></h2>
<p><strong>Constructing the confidence interval with t-statistic:</strong></p>
<ul>
<li><p>Suppose given a sample <span class="math inline">x_1, \ldots, x_n</span> from <span class="math inline">N(\mu,\sigma^2)</span></p></li>
<li><p>Recall: the t-statistic has t-distribution <span class="math display">
t = \frac{\overline{x}-\mu}{\mathop{\mathrm{e.s.e.}}} \, \sim  \, t_{n-1} \,, \qquad \mathop{\mathrm{e.s.e.}}= \frac{s}{\sqrt{n}}
</span></p></li>
<li><p>We impose that <span class="math inline">t</span> is observed with probability <span class="math inline">0.95</span> <span class="math display">
P(- t^* \leq t \leq t^*) = 0.95 \,, \qquad
t^* = t_{n-1}(0.025)
</span></p></li>
<li><p>The <span class="math inline">95\%</span> confidence interval is obtained by solving above equation for <span class="math inline">\mu</span> <span class="math display">
P(\mu \in [a,b] ) = 0.95 \,, \qquad
a = \overline{x} - t^* \times \mathop{\mathrm{e.s.e.}}, \qquad  
b = \overline{x} + t^* \times \mathop{\mathrm{e.s.e.}}
</span></p></li>
<li><p><strong>Interpretation:</strong> If you sample over and over again, the interval <span class="math inline">[a,b]</span> will contain <span class="math inline">\mu</span> about <span class="math inline">95\%</span> of the times</p></li>
</ul>
</section>
<section id="section-19" class="slide level2 smaller">
<h2></h2>

<img data-src="images/CI_interpretation.png" style="width:100.0%" class="r-stretch"><div style="font-size: 0.85em">
<ul>
<li><p>Each row of points is a sample from the same normal distribution <span class="math inline">\qquad</span> (Image from <a href="https://en.wikipedia.org/wiki/Confidence_interval#/media/File:Normal_distribution_50%25_CI_illustration.svg">Wikipedia</a>)</p></li>
<li><p>The colored lines are confidence intervals for the mean <span class="math inline">\mu</span></p></li>
<li><p>At the center of each interval is the sample mean (diamond)</p></li>
<li><p>The blue intervals contain the population mean, and the red ones do not</p></li>
</ul>
</div>
</section>
<section id="section-20" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.92em">
<p><strong>Simulating one confidence interval in R:</strong></p>
<ul>
<li>Sample <span class="math inline">n = 100</span> times from <span class="math inline">N(0,1)</span>
<ul>
<li>Running a t-test on the sample gives a confidence interval for the unknown mean <span class="math inline">\mu</span></li>
<li>The confidence interval can be retrieved with <code>$conf.int</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Sample 100 times from N(0,1)</span></span>
<span id="cb23-2"><a aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb23-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute confidence interval using t.test</span></span>
<span id="cb23-5"><a aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>interval</code> is a vector containing the simulated confidence interval
<ul>
<li>Left extreme in <code>interval[1]</code> <span class="math inline">\qquad</span> Right extreme in <code>interval[2]</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> interval[<span class="dv">1</span>];   b <span class="ot">&lt;-</span> interval[<span class="dv">2</span>]</span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Simulated confidence interval: a ="</span>, a, <span class="st">"  b = "</span>, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Simulated confidence interval: a = -0.2262375   b =  0.1689576</code></pre>
</div>
</div>
<ul>
<li>In this case the interval contains the true mean <span class="math inline">\mu = 0</span></li>
</ul>
</div>
</section>
<section id="section-21" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.96em">
<p><strong>Testing the claim:</strong> <span class="math inline">\quad P (\mu \in [a,b]) = 0.95</span></p>
<ul>
<li><em>If you sample over and over, the interval <span class="math inline">[a,b]</span> will contain <span class="math inline">\mu</span> about <span class="math inline">95\%</span> of the times</em></li>
</ul>
<p>We test with the following method:</p>
<ul>
<li><p>Sample <span class="math inline">n = 100</span> times from <span class="math inline">N(0,1)</span> and compute confidence interval</p></li>
<li><p>Repeat <span class="math inline">M = 1000</span> times</p></li>
<li><p>Check how many times <span class="math inline">\mu = 0</span> belongs to simulated confidence intervals</p></li>
<li><p>Estimate the probability of the CI containing <span class="math inline">\mu</span> as <span class="math display">
P(\mu \in [a,b]) \approx \frac{\# \text{ of times } \mu = 0 \text{ belongs to simulated } [a,b]}{M}
</span></p></li>
<li><p>The estimate should approach <span class="math inline">0.95</span></p></li>
</ul>
</div>
</section>
<section id="section-22" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.96em">
<ul>
<li>First, we simulate the <span class="math inline">M = 1000</span> confidence intervals</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate M confidence intervals for the mean</span></span>
<span id="cb26-2"><a aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>; M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb26-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, <span class="fu">t.test</span>(<span class="fu">rnorm</span>(n)) <span class="sc">$</span> conf.int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><code>intervals</code> is a matrix containing the <span class="math inline">M = 1000</span> simulated intervals (as columns)
<ul>
<li>Left extremes are in <code>intervals[1, ]</code></li>
<li>Right extremes are in <code>intervals[2, ]</code></li>
</ul></li>
<li>For visualization, we print the first 5 confidence intervals</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print the first 5 columns of intervals</span></span>
<span id="cb27-2"><a aria-hidden="true" tabindex="-1"></a>intervals[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]        [,2]       [,3]       [,4]        [,5]
[1,] -0.2262375 -0.07222545 -0.2428610 -0.1788659 -0.07420973
[2,]  0.1689576  0.35116698  0.1201007  0.2189942  0.30661995</code></pre>
</div>
</div>
</div>
</section>
<section id="section-23" class="slide level2 smaller">
<h2></h2>
<div style="font-size: 0.9em">
<ul>
<li><p>Now, we have our <span class="math inline">M = 1000</span> confidence intervals for <span class="math inline">\mu = 0</span></p></li>
<li><p>Check how many times <span class="math inline">\mu = 0</span> belongs to simulated confidence intervals</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Save left and right extremes in vectors</span></span>
<span id="cb29-2"><a aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> intervals[<span class="dv">1</span>, ];   b <span class="ot">&lt;-</span> intervals[<span class="dv">2</span>, ]</span>
<span id="cb29-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many times mu = 0 belongs to (a,b)</span></span>
<span id="cb29-5"><a aria-hidden="true" tabindex="-1"></a>mu.belongs <span class="ot">&lt;-</span> <span class="fu">sum</span>( (a <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (<span class="dv">0</span> <span class="sc">&lt;</span> b) )</span>
<span id="cb29-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the probability that mu = 0 belongs to (a,b)</span></span>
<span id="cb29-8"><a aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> mu.belongs <span class="sc">/</span> M</span>
<span id="cb29-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"mu = 0 belongs to the confidence interval with probability"</span>, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>mu = 0 belongs to the confidence interval with probability 0.9494</code></pre>
</div>
</div>
<ul>
<li>This approximates the theoretical probability <span class="math display">
P(\mu \in [a,b]) = 0.95
</span> (we would need more confidence intervals for a better estimate)</li>
</ul>
</div>
</section></section>
<section>
<section id="part-6-simulating-p-values" class="title-slide slide level1 center" data-background-color="#cc0164" data-visibility="uncounted">
<h1>Part 6: <br>Simulating p-values</h1>
<div class="footer">
<div color="#cc0164">

</div>
</div>
</section>
<section id="the-problem-of-simulating-p-values" class="slide level2 smaller">
<h2>The problem of simulating p-values</h2>
<p>Suppose given a random variable <span class="math inline">X</span> such that</p>
<ul>
<li><p>The distribution of <span class="math inline">X</span> is (possibly) unknown</p></li>
<li><p>A method for <strong>simulating</strong> <span class="math inline">X</span> is available</p>
<ul>
<li>This means we can (somehow) sample values from <span class="math inline">X</span></li>
</ul></li>
</ul>
<p><strong>Goal:</strong> For a given <span class="math inline">x^*</span>, we want to estimate the p-value</p>
<p><span class="math display">
p = P(X &gt; x^*)
</span></p>
</section>
<section id="general-recipe-to-simulate-p-values" class="slide level2 smaller">
<h2>General recipe to simulate p-values</h2>
<p><strong>Goal:</strong> Estimate the p-value <span class="math inline">p = P(X&gt;x^*)</span></p>
<ol type="1">
<li><p>Simuate the random varible <span class="math inline">X</span>. You obtain a numerical value <span class="math inline">X_{\rm sim}</span></p></li>
<li><p>The simulated value is <strong>extreme</strong> if <span class="math display">
X_{\rm sim} &gt; x^*
</span></p></li>
<li><p>There are two possibilities:</p>
<ul>
<li><span class="math inline">X_{\rm sim}</span> is extreme <span class="math inline">\quad \,\,\, \quad \implies \quad</span> simulation goes in favor of <span class="math inline">\, p</span></li>
<li><span class="math inline">X_{\rm sim}</span> is not extreme <span class="math inline">\quad \implies \quad</span> simulation goes in favor of <span class="math inline">\, 1-p</span></li>
</ul></li>
<li><p>We <strong>estimate</strong> the p-value as <span class="math display">
p =  P( X &gt; x^* ) \ \approx \ \frac{ \# \text{ of extreme simulated values} }{ \text{Total number of simulations} }
</span></p></li>
</ol>
</section>
<section id="example-monte-carlo-p-value-for-goodness-of-fit-test" class="slide level2 smaller">
<h2>Example: Monte Carlo p-value for goodness-of-fit test</h2>
<p><strong>Goal:</strong> use Monte Carlo simulations to compute p-value for <strong>goodness-of-fit</strong> test</p>
<ul>
<li>Consider data counts</li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">\ldots</span></th>
<th style="text-align: center;"><span class="math inline">n</span></th>
<th style="text-align: center;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed counts</td>
<td style="text-align: center;"><span class="math inline">o_1</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">o_n</span></td>
<td style="text-align: center;"><span class="math inline">m</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Null Probabilities</td>
<td style="text-align: center;"><span class="math inline">p_1^0</span></td>
<td style="text-align: center;"><span class="math inline">\ldots</span></td>
<td style="text-align: center;"><span class="math inline">p_n^0</span></td>
<td style="text-align: center;"><span class="math inline">1</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p>The expected counts are <span class="math inline">E_i = m p_i^0</span></p></li>
<li><p>Under the null hypothesis, the observed counts <span class="math inline">(o_1, \ldots, o_n)</span> come from <span class="math display">
(O_1 , \ldots, O_n) \sim \mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)
</span></p></li>
</ul>
</section>
<section id="p-value-for-goodness-of-fit-test" class="slide level2 smaller">
<h2>p-value for goodness-of-fit test</h2>
<ul>
<li><p>The chi-squared statistic <em>random variable</em> is <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i }
</span></p></li>
<li><p>The observed chi-squared statistics is <span class="math display">
\chi^2_{\rm obs} = \sum_{i=1}^n \frac{(o_i - E_i)^2 }{ E_i }
</span></p></li>
<li><p>The p-value is defined as <span class="math display">
p = P( \chi^2 &gt; \chi^2_{\rm obs} )
</span></p></li>
</ul>
</section>
<section id="problem-computing-p-value-for-low-counts" class="slide level2 smaller">
<h2>Problem: Computing p-value for low counts</h2>
<ul>
<li><p>Suppose <span class="math inline">E_i &lt; 5</span> for some <span class="math inline">i</span></p></li>
<li><p>In this case, <span class="math inline">\chi^2</span> is <strong>not</strong> <span class="math inline">\chi^2_{n-1}</span> distributed</p></li>
<li><p>In fact, the distribution is <strong>unknown</strong> <span class="math display">
\chi^2 = \sum_{i=1}^n \frac{(O_i - E_i)^2 }{ E_i }  \ \, \sim \ \, ???
</span></p></li>
<li><p>If the distribution is unknown, how do we compute the p-value <span class="math display">
p = P( \chi^2 &gt; \chi^2_{\rm obs} )  \ \ ???
</span></p></li>
</ul>
<p><strong>Exercise</strong>: Come up with a simulation to approximate <span class="math inline">p</span></p>
</section>
<section id="method-simulating-p-value-for-chi2-statistic" class="slide level2 smaller">
<h2>Method: Simulating p-value for <span class="math inline">\chi^2</span> statistic</h2>
<div style="font-size: 0.94em">
<ol type="1">
<li><p>Simulate counts <span class="math inline">(o_1^{\rm sim},\ldots,o_n^{\rm sim})</span> from <span class="math inline">\mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)</span></p></li>
<li><p>Compute the corresponding simulated chi-squared statistic <span class="math display">
\chi^2_{\rm sim} = \sum_{i=1}^n \frac{ (o_i^{\rm sim} - E_i)^2 }{E_i} \,, \qquad E_i := m p_i^0
</span></p></li>
<li><p>The simulated chi-squared statistic is <strong>extreme</strong> if <span class="math display">
\chi^2_{\rm sim} &gt; \chi^2_{\rm obs} \,, \quad \text{ where \, } \chi^2_{\rm obs} = \sum_{i=1}^n \frac{(o_i - E_i)^2 }{ E_i } \,, \,\, o_i \, \text{ the observed counts}
</span></p></li>
<li><p>We <strong>estimate</strong> the theoretical p-value by <span class="math display">
p =  P( \chi^2 &gt; \chi^2_{\rm obs} ) \ \approx \ \frac{ \# \text{ of extreme simulated statistics} }{ \text{Total number of simulations} }
</span></p></li>
</ol>
</div>
</section>
<section id="exercise" class="slide level2 smaller">
<h2>Exercise</h2>
<div style="font-size: 0.94em">
<p><strong>Data:</strong> Number of defects in printed circuit boards, along with null probabilities</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"># Defects</th>
<th style="text-align: center;"><span class="math inline">0</span></th>
<th style="text-align: center;"><span class="math inline">1</span></th>
<th style="text-align: center;"><span class="math inline">2</span></th>
<th style="text-align: center;"><span class="math inline">3</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Counts</strong></td>
<td style="text-align: center;"><span class="math inline">32</span></td>
<td style="text-align: center;"><span class="math inline">15</span></td>
<td style="text-align: center;"><span class="math inline">9</span></td>
<td style="text-align: center;"><span class="math inline">4</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Null Probabilities</strong></td>
<td style="text-align: center;"><span class="math inline">0.5</span></td>
<td style="text-align: center;"><span class="math inline">0.3</span></td>
<td style="text-align: center;"><span class="math inline">0.15</span></td>
<td style="text-align: center;"><span class="math inline">0.05</span></td>
</tr>
</tbody>
</table>
<ul>
<li>Total number of counts is <span class="math inline">m = 60</span>. Expected counts are <span class="math inline">E_i = m p_i^0</span></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">E_1</span></th>
<th style="text-align: center;"><span class="math inline">E_2</span></th>
<th style="text-align: center;"><span class="math inline">E_3</span></th>
<th style="text-align: center;"><span class="math inline">E_4</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">30</span></td>
<td style="text-align: center;"><span class="math inline">18</span></td>
<td style="text-align: center;"><span class="math inline">9</span></td>
<td style="text-align: center;"><span class="math inline">3</span></td>
</tr>
</tbody>
</table>
<ul>
<li><p><strong>Note:</strong> <span class="math inline">E_4 = 3 &lt; 5 \quad \implies \quad</span> the distribution of <span class="math inline">\chi^2</span> is unknown</p></li>
<li><p><strong>Exercise</strong>: Write R code to perform a goodness-of-fit test on above data</p>
<ul>
<li>You may not use the function <code>chisq.test</code></li>
<li>p-value should be simulated (see previous slide)</li>
</ul></li>
</ul>
</div>
</section>
<section id="solution-1" class="slide level2 smaller">
<h2>Solution</h2>
<ul>
<li>First, compute the observed chi-squared statistic:
<ul>
<li>Enter observed counts and null probabilities</li>
<li>Compute total counts, expected counts and <span class="math inline">\chi^2_{\rm obs}</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Enter counts and null hypothesis probabilities</span></span>
<span id="cb31-2"><a aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">32</span>, <span class="dv">15</span>, <span class="dv">9</span>, <span class="dv">4</span>)</span>
<span id="cb31-3"><a aria-hidden="true" tabindex="-1"></a>null.p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>)</span>
<span id="cb31-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute total counts</span></span>
<span id="cb31-6"><a aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(counts)</span>
<span id="cb31-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute expected counts</span></span>
<span id="cb31-9"><a aria-hidden="true" tabindex="-1"></a>exp.counts <span class="ot">&lt;-</span> m <span class="sc">*</span> null.p</span>
<span id="cb31-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the observed chi-squared statistic</span></span>
<span id="cb31-12"><a aria-hidden="true" tabindex="-1"></a>obs.chi <span class="ot">&lt;-</span> <span class="fu">sum</span>( (counts <span class="sc">-</span> exp.counts)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp.counts )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-24" class="slide level2 smaller">
<h2></h2>
<p>We now generate <span class="math inline">M = 10000</span> simulated chi-squared statistics:</p>
<ol type="1">
<li><p>Simulate counts <span class="math inline">(o_1^{\rm sim},\ldots,o_n^{\rm sim})</span> from <span class="math inline">\mathop{\mathrm{Mult}}(m, p_1^0, \ldots, p_n^0)</span></p></li>
<li><p>Compute the corresponding simulated chi-squared statistic <span class="math display">
\chi^2_{\rm sim} = \sum_{i=1}^n \frac{ (o_i^{\rm sim} - E_i)^2 }{E_i}
</span></p></li>
</ol>
<div style="font-size: 0.94em">
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate M chi-squared statistics</span></span>
<span id="cb32-2"><a aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb32-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a aria-hidden="true" tabindex="-1"></a>sim.chi <span class="ot">&lt;-</span> <span class="fu">replicate</span>(M, {</span>
<span id="cb32-5"><a aria-hidden="true" tabindex="-1"></a>                <span class="co"># Simulate multinomial counts under null hypothesis</span></span>
<span id="cb32-6"><a aria-hidden="true" tabindex="-1"></a>                sim.counts <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="dv">1</span>, m, null.p)</span>
<span id="cb32-7"><a aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb32-8"><a aria-hidden="true" tabindex="-1"></a>                <span class="co"># Reurn chi-squared statistic from the simulated counts</span></span>
<span id="cb32-9"><a aria-hidden="true" tabindex="-1"></a>                <span class="fu">sum</span>( (sim.counts <span class="sc">-</span> exp.counts )<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> exp.counts)</span>
<span id="cb32-10"><a aria-hidden="true" tabindex="-1"></a>                })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-25" class="slide level2 smaller">
<h2></h2>
<ul>
<li><p>The vector <code>sim.chi</code> contains <span class="math inline">M = 10000</span> simulated chi-squared statistics</p></li>
<li><p>We approximate the p-value by <span class="math display">
p = P(\chi^2 &gt; \chi_{\rm obs}^2) \approx
\ \frac{ \# \text{ of extreme simulated statistics} }{ M }
</span></p></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Check how many simulated statistics are extreme</span></span>
<span id="cb33-2"><a aria-hidden="true" tabindex="-1"></a>num.extreme <span class="ot">&lt;-</span> <span class="fu">sum</span>( sim.chi <span class="sc">&gt;</span> obs.chi )</span>
<span id="cb33-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the p-value</span></span>
<span id="cb33-5"><a aria-hidden="true" tabindex="-1"></a>sim.p.value <span class="ot">&lt;-</span> num.extreme <span class="sc">/</span> M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="section-26" class="slide level2 smaller">
<h2></h2>
<ul>
<li>As cross check, we also simulate the p-value with <code>chisq.test</code></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Perform chi-squared test using built-in R function</span></span>
<span id="cb34-2"><a aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(counts, <span class="at">p =</span> null.p, <span class="at">simulate.p.value =</span> T)</span>
<span id="cb34-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Extract p-value from chi-squared test result</span></span>
<span id="cb34-5"><a aria-hidden="true" tabindex="-1"></a>R.p.value <span class="ot">&lt;-</span> ans<span class="sc">$</span>p.value</span>
<span id="cb34-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Print p-values for comparison</span></span>
<span id="cb34-8"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Our simulated p-value is:"</span>, sim.p.value)</span>
<span id="cb34-9"><a aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">R simulated p-value is:"</span>, R.p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Our simulated p-value is: 0.8169</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
R simulated p-value is: 0.8195902</code></pre>
</div>
</div>
<div style="font-size: 0.51em">
<p><br></p>
</div>
<ul>
<li><p><strong>Note</strong>: The simulated p-values are the same! (up to random fluctuations)</p></li>
<li><p><strong>Conclusion:</strong> We see that <span class="math inline">p &gt; 0.05</span>. There is not enogh evidence to reject <span class="math inline">H_0</span></p></li>
</ul>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p><a href="../index.html">Homepage</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="../license.html">License</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href="https://www.silviofanzon.com/contact">Contact</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>